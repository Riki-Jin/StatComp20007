<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Zhang Jin 20007" />


<title>Homeworks</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homeworks</h1>
<h4 class="author">Zhang Jin 20007</h4>
<h4 class="date">2020/12/18</h4>



<div id="assert" class="section level1">
<h1>Assert</h1>
<p>In order to shorten the compile time of the vignette, I reduce the sample size or forbid running of several exercises comparing with my assignment submitted. To be specific, the difference will be listed down below:</p>
<p>Reduction of sample size:</p>
<ol style="list-style-type: decimal">
<li>Homework 5, Exercise 6.C, I reduce the two sample sizes 1000 and 100 respectively to 100 and 30.</li>
</ol>
<p>Forbiddance of running:</p>
<ol style="list-style-type: decimal">
<li><p>Homework 7, Discussion</p></li>
<li><p>Homework 8, Gelman-Rubin method.</p></li>
</ol>
</div>
<div id="homework-1-2020-09-22" class="section level1">
<h1>Homework 1 (2020-09-22)</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce 3 examples in the book. The 1st example should contain texts and at least one figure. The 2nd example should contains texts and at least one table. The 3rd example should contain at least a couple of LaTeX formulas.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="section" class="section level3">
<h3>(1)</h3>
<p>In my first example, I used lattice package to make density plot. For the randomly generated data, I plotted both empirical density curve and normal fitting curve.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(lattice)</span>
<span id="cb1-2"><a href="#cb1-2"></a>n &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">5</span>, <span class="dv">45</span>, <span class="dv">5</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">sum</span>(n))</span>
<span id="cb1-4"><a href="#cb1-4"></a>y &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">rep</span>(n, n), <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;n =&quot;</span>, n))</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">densityplot</span>(<span class="op">~</span><span class="st"> </span>x <span class="op">|</span><span class="st"> </span>y,</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="dt">panel =</span> <span class="cf">function</span>(x, ...) {</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="kw">panel.densityplot</span>(x, <span class="dt">col=</span><span class="st">&quot;DarkOliveGreen&quot;</span>, ...)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw">panel.mathdensity</span>(<span class="dt">dmath=</span>dnorm,</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="dt">args=</span><span class="kw">list</span>(<span class="dt">mean=</span><span class="kw">mean</span>(x), <span class="dt">sd=</span><span class="kw">sd</span>(x)),</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="dt">col=</span><span class="st">&quot;darkblue&quot;</span>)</span>
<span id="cb1-11"><a href="#cb1-11"></a>})</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-1" class="section level3">
<h3>(2)</h3>
<p>In my second example, I used some methods to deal with the longitudinal data of some patients.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>stdv =<span class="st"> </span><span class="cf">function</span>(x) {  <span class="cf">if</span> (<span class="kw">NROW</span>(x)<span class="op">&gt;</span><span class="dv">1</span>)   sigma &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">sd</span>(x),<span class="dv">2</span>) </span>
<span id="cb2-2"><a href="#cb2-2"></a>                                   <span class="cf">else</span>   sigma &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>                                   sigma }</span>
<span id="cb2-4"><a href="#cb2-4"></a>smry &lt;-<span class="st"> </span><span class="cf">function</span>(X){     mu &lt;-<span class="st"> </span><span class="kw">apply</span>(X,<span class="dv">2</span>,mean)  </span>
<span id="cb2-5"><a href="#cb2-5"></a>sigma &lt;-<span class="st"> </span><span class="kw">apply</span>(X,<span class="dv">2</span>,stdv)</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="kw">c</span>(<span class="dt">mu=</span>mu,<span class="dt">sigma=</span>sigma)}</span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a>patients &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;0071021198307012008001400400150&quot;</span>,</span>
<span id="cb2-9"><a href="#cb2-9"></a>                       <span class="st">&quot;0071201198307213009002000500200&quot;</span>,</span>
<span id="cb2-10"><a href="#cb2-10"></a>                      <span class="st">&quot;0090903198306611007013700300000&quot;</span>,</span>
<span id="cb2-11"><a href="#cb2-11"></a>                      <span class="st">&quot;0050705198307414008201300900000&quot;</span>,</span>
<span id="cb2-12"><a href="#cb2-12"></a>                     <span class="st">&quot;0050115198208018009601402001500&quot;</span>,</span>
<span id="cb2-13"><a href="#cb2-13"></a>                     <span class="st">&quot;0050618198207017008401400800400&quot;</span>,</span>
<span id="cb2-14"><a href="#cb2-14"></a>                     <span class="st">&quot;0050703198306414008401400800200&quot;</span>)</span>
<span id="cb2-15"><a href="#cb2-15"></a>id &lt;-<span class="st"> </span><span class="kw">substr</span>(patients,<span class="dv">1</span>,<span class="dv">3</span>)    <span class="co"># First 3 digits signify the patient ID</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>date &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="kw">substr</span>(patients,<span class="dv">4</span>,<span class="dv">11</span>), <span class="dt">format =</span> <span class="st">&quot;%m%d%Y&quot;</span>)    <span class="co"># 4-11 for treatment date</span></span>
<span id="cb2-17"><a href="#cb2-17"></a>hr &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">substr</span>(patients,<span class="dv">12</span>,<span class="dv">14</span>))    <span class="co"># Heart rate</span></span>
<span id="cb2-18"><a href="#cb2-18"></a>sbp &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">substr</span>(patients,<span class="dv">15</span>,<span class="dv">17</span>))    <span class="co"># Systolic blood pressure</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>dbp &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">substr</span>(patients,<span class="dv">18</span>,<span class="dv">20</span>))    <span class="co"># Diastolic blood pressure</span></span>
<span id="cb2-20"><a href="#cb2-20"></a>dx &lt;-<span class="st"> </span><span class="kw">substr</span>(patients,<span class="dv">21</span>,<span class="dv">23</span>)</span>
<span id="cb2-21"><a href="#cb2-21"></a>docfee &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">substr</span>(patients,<span class="dv">24</span>,<span class="dv">27</span>))  </span>
<span id="cb2-22"><a href="#cb2-22"></a>labfee &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">substr</span>(patients,<span class="dv">28</span>,<span class="dv">31</span>))</span>
<span id="cb2-23"><a href="#cb2-23"></a></span>
<span id="cb2-24"><a href="#cb2-24"></a><span class="kw">tapply</span>(hr, id, mean)</span></code></pre></div>
<pre><code>## 005 007 009 
##  72  71  66</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">tapply</span>(hr, id, stdv)</span></code></pre></div>
<pre><code>##  005  007  009 
## 6.73 1.41 0.00</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Show these results in a more compact way</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>PATIENTS &lt;-<span class="st"> </span><span class="kw">data.frame</span>(id, hr, sbp, dbp, docfee, labfee)</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="kw">str</span>(PATIENTS)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    7 obs. of  6 variables:
##  $ id    : chr  &quot;007&quot; &quot;007&quot; &quot;009&quot; &quot;005&quot; ...
##  $ hr    : num  70 72 66 74 80 70 64
##  $ sbp   : num  120 130 110 140 180 170 140
##  $ dbp   : num  80 90 70 82 96 84 84
##  $ docfee: num  40 50 30 90 200 80 80
##  $ labfee: num  150 200 0 0 1500 400 200</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">smry</span>(PATIENTS[id<span class="op">==</span><span class="st">&#39;005&#39;</span>,<span class="dv">2</span><span class="op">:</span><span class="dv">6</span>])</span></code></pre></div>
<pre><code>##        mu.hr       mu.sbp       mu.dbp    mu.docfee    mu.labfee     sigma.hr 
##        72.00       157.50        86.50       112.50       525.00         6.73 
##    sigma.sbp    sigma.dbp sigma.docfee sigma.labfee 
##        20.62         6.40        58.52       670.20</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">smry</span>(PATIENTS[id<span class="op">==</span><span class="st">&#39;007&#39;</span>,<span class="dv">2</span><span class="op">:</span><span class="dv">6</span>])</span></code></pre></div>
<pre><code>##        mu.hr       mu.sbp       mu.dbp    mu.docfee    mu.labfee     sigma.hr 
##        71.00       125.00        85.00        45.00       175.00         1.41 
##    sigma.sbp    sigma.dbp sigma.docfee sigma.labfee 
##         7.07         7.07         7.07        35.36</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">smry</span>(PATIENTS[id<span class="op">==</span><span class="st">&#39;009&#39;</span>,<span class="dv">2</span><span class="op">:</span><span class="dv">6</span>])</span></code></pre></div>
<pre><code>##        mu.hr       mu.sbp       mu.dbp    mu.docfee    mu.labfee     sigma.hr 
##           66          110           70           30            0            0 
##    sigma.sbp    sigma.dbp sigma.docfee sigma.labfee 
##            0            0            0            0</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">by</span>(PATIENTS[<span class="dv">2</span><span class="op">:</span><span class="dv">6</span>], id, smry) </span></code></pre></div>
<pre><code>## id: 005
##        mu.hr       mu.sbp       mu.dbp    mu.docfee    mu.labfee     sigma.hr 
##        72.00       157.50        86.50       112.50       525.00         6.73 
##    sigma.sbp    sigma.dbp sigma.docfee sigma.labfee 
##        20.62         6.40        58.52       670.20 
## ------------------------------------------------------------ 
## id: 007
##        mu.hr       mu.sbp       mu.dbp    mu.docfee    mu.labfee     sigma.hr 
##        71.00       125.00        85.00        45.00       175.00         1.41 
##    sigma.sbp    sigma.dbp sigma.docfee sigma.labfee 
##         7.07         7.07         7.07        35.36 
## ------------------------------------------------------------ 
## id: 009
##        mu.hr       mu.sbp       mu.dbp    mu.docfee    mu.labfee     sigma.hr 
##           66          110           70           30            0            0 
##    sigma.sbp    sigma.dbp sigma.docfee sigma.labfee 
##            0            0            0            0</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">by</span>(PATIENTS[<span class="dv">2</span><span class="op">:</span><span class="dv">6</span>], id, summary)</span></code></pre></div>
<pre><code>## id: 005
##        hr            sbp             dbp           docfee          labfee    
##  Min.   :64.0   Min.   :140.0   Min.   :82.0   Min.   : 80.0   Min.   :   0  
##  1st Qu.:68.5   1st Qu.:140.0   1st Qu.:83.5   1st Qu.: 80.0   1st Qu.: 150  
##  Median :72.0   Median :155.0   Median :84.0   Median : 85.0   Median : 300  
##  Mean   :72.0   Mean   :157.5   Mean   :86.5   Mean   :112.5   Mean   : 525  
##  3rd Qu.:75.5   3rd Qu.:172.5   3rd Qu.:87.0   3rd Qu.:117.5   3rd Qu.: 675  
##  Max.   :80.0   Max.   :180.0   Max.   :96.0   Max.   :200.0   Max.   :1500  
## ------------------------------------------------------------ 
## id: 007
##        hr            sbp             dbp           docfee         labfee     
##  Min.   :70.0   Min.   :120.0   Min.   :80.0   Min.   :40.0   Min.   :150.0  
##  1st Qu.:70.5   1st Qu.:122.5   1st Qu.:82.5   1st Qu.:42.5   1st Qu.:162.5  
##  Median :71.0   Median :125.0   Median :85.0   Median :45.0   Median :175.0  
##  Mean   :71.0   Mean   :125.0   Mean   :85.0   Mean   :45.0   Mean   :175.0  
##  3rd Qu.:71.5   3rd Qu.:127.5   3rd Qu.:87.5   3rd Qu.:47.5   3rd Qu.:187.5  
##  Max.   :72.0   Max.   :130.0   Max.   :90.0   Max.   :50.0   Max.   :200.0  
## ------------------------------------------------------------ 
## id: 009
##        hr          sbp           dbp         docfee       labfee 
##  Min.   :66   Min.   :110   Min.   :70   Min.   :30   Min.   :0  
##  1st Qu.:66   1st Qu.:110   1st Qu.:70   1st Qu.:30   1st Qu.:0  
##  Median :66   Median :110   Median :70   Median :30   Median :0  
##  Mean   :66   Mean   :110   Mean   :70   Mean   :30   Mean   :0  
##  3rd Qu.:66   3rd Qu.:110   3rd Qu.:70   3rd Qu.:30   3rd Qu.:0  
##  Max.   :66   Max.   :110   Max.   :70   Max.   :30   Max.   :0</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># Calculate the difference between the first and the last observations of HR, SBP and DBP</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>HrSbpDbp  &lt;-<span class="st"> </span><span class="kw">data.frame</span>(id, date, hr, sbp, dbp)</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co"># Sort by ID first, then sort by treatment date</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>HrSbpDbpSorted &lt;-<span class="st"> </span>HrSbpDbp[<span class="kw">order</span>(HrSbpDbp<span class="op">$</span>id, HrSbpDbp<span class="op">$</span>date), ] </span>
<span id="cb18-5"><a href="#cb18-5"></a>HrSbpDbpSorted</span></code></pre></div>
<pre><code>##    id       date hr sbp dbp
## 5 005 1982-01-15 80 180  96
## 6 005 1982-06-18 70 170  84
## 7 005 1983-07-03 64 140  84
## 4 005 1983-07-05 74 140  82
## 1 007 1983-10-21 70 120  80
## 2 007 1983-12-01 72 130  90
## 3 009 1983-09-03 66 110  70</code></pre>
</div>
<div id="section-2" class="section level3">
<h3>(3)</h3>
<p>In this example, I listed several theorems using some Latex copulas.</p>
<p>Levy CLT:</p>
<p><span class="math inline">\(\displaystyle\frac{\sqrt{n}(\bar{X} - \mu)}{\sigma} \stackrel{d}{\longrightarrow} N(0,1)\)</span></p>
<p>Berry-Esseen CLT:</p>
<p><span class="math inline">\(\displaystyle\sup_{t} |G_n(t)-\Phi(t)| \leq C \frac{\rho}{\sigma^3 \sqrt{n}}\)</span></p>
<p>Percentile CLT:</p>
<p><span class="math inline">\(\displaystyle\lim_{n \rightarrow \infty} P \Big( \frac{\sqrt{n} (\hat{\xi}_{pn}-\xi_p)}{\sqrt{p(1-p)}/F&#39;(\xi_p -)} \leq t \Big) = \Phi(t)\)</span></p>
<p><span class="math inline">\(~\)</span></p>
<p><span class="math inline">\(~\)</span></p>
</div>
</div>
</div>
<div id="homework-2-2020-09-29" class="section level1">
<h1>Homework 2 (2020-09-29)</h1>
<div id="exercise-3.3" class="section level2">
<h2>Exercise 3.3</h2>
<div id="problem" class="section level3">
<h3>Problem</h3>
<p>The Pareto(a, b) distribution has cdf</p>
<p><span class="math display">\[\displaystyle F(x)=1-(\frac{b}{x})^a,~~~~~~~x \geq b &gt;0,~a&gt;0.\]</span></p>
<p>Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto(2,2) distribution. Graph the density histogram of the sample with the Pareto(2,2) density superimposed for comparison.</p>
</div>
<div id="solution" class="section level3">
<h3>Solution</h3>
<p>First, for the cdf</p>
<p><span class="math display">\[\displaystyle F(x)=1-(\frac{b}{x})^a,~~~~~~~x \geq b &gt;0,~a&gt;0\]</span>,</p>
<p>I can derive its inverse</p>
<p><span class="math display">\[\displaystyle F^{-1}(x)=\frac{b}{\sqrt[a]{1-x}}~~~~~~~0 \leq x \leq 1,~a&gt;0\]</span>,</p>
<p>Then I could generate random variables from Uniform(0,1).</p>
<p>I will simulate a sample number of 10000, <span class="math inline">\(a=b=2\)</span> as the exercise suggests.<br />
The pdf of the Pareto(a,b) distribution is</p>
<p><span class="math display">\[f(x)=\displaystyle \frac{ab^a}{x^{a+1}},~~~~~~~x \geq b &gt;0,~a&gt;0\]</span></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>n &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>a &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>b &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>unifrv &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb20-5"><a href="#cb20-5"></a>paretorv &lt;-<span class="st"> </span>b<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>unifrv)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>a)    <span class="co"># inverse transformation</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="kw">hist</span>(paretorv[paretorv<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>paretorv<span class="op">&lt;</span><span class="dv">20</span>], <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="fl">0.5</span>), <span class="dt">main =</span> <span class="st">&quot;Histogram of the Pareto sample with the true density curve&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;Sample value&quot;</span>)    <span class="co"># graph the density histogram</span></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="co"># I found that F(20)=0.99, which is very close to 1. For the sake of the tidiness and better description for the feature of the histogram, I made a truncation on x=20, and only consider the variables between 0 and 20.</span></span>
<span id="cb20-8"><a href="#cb20-8"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x) {a<span class="op">*</span>b<span class="op">^</span>a<span class="op">/</span>x<span class="op">^</span>(a<span class="op">+</span><span class="dv">1</span>)}    <span class="co"># true pdf</span></span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="kw">curve</span>(f, <span class="dv">2</span>, <span class="dv">20</span>, <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)    <span class="co"># add the true density curve</span></span>
<span id="cb20-10"><a href="#cb20-10"></a><span class="kw">legend</span>(<span class="dv">12</span>,<span class="fl">0.6</span>,<span class="st">&quot;true density&quot;</span>, <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">3</span>)    <span class="co"># add a legend</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="exercise-3.9" class="section level2">
<h2>Exercise 3.9</h2>
<div id="problem-1" class="section level3">
<h3>Problem</h3>
<p>The rescaled Epanechnikov kernel is a symmetric density function</p>
<p><span class="math display">\[\displaystyle f_e(x)=\frac{3}{4}(1-x^2),~~~~~~~|x| \leq 1\]</span></p>
<p>Devroye and Gyorfi give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U_1,U_2,U_3 \sim\)</span> Uniform(-1,1). If <span class="math inline">\(|U_3|\geq|U_2|\)</span> and <span class="math inline">\(|U_3|\geq|U_1|\)</span>, deliver <span class="math inline">\(U_2\)</span>; otherwise deliver |U_3|. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density estimate of a large simulated random sample.</p>
</div>
<div id="solution-1" class="section level3">
<h3>Solution</h3>
<p>Just do as the problem suggests. Consider a sample number of 10000.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>u1 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10000</span>, <span class="dt">min =</span> <span class="dv">-1</span>, <span class="dt">max =</span> <span class="dv">1</span>)    <span class="co"># consider a sample number of 10000</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>u2 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10000</span>, <span class="dt">min =</span> <span class="dv">-1</span>, <span class="dt">max =</span> <span class="dv">1</span>)</span>
<span id="cb21-3"><a href="#cb21-3"></a>u3 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10000</span>, <span class="dt">min =</span> <span class="dv">-1</span>, <span class="dt">max =</span> <span class="dv">1</span>)</span>
<span id="cb21-4"><a href="#cb21-4"></a>u &lt;-<span class="st"> </span><span class="kw">ifelse</span>((<span class="kw">abs</span>(u3)<span class="op">&gt;</span><span class="kw">abs</span>(u2) <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(u3)<span class="op">&gt;</span><span class="kw">abs</span>(u1)), u2, u3)</span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="kw">hist</span>(u, <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.02</span>), <span class="dt">main =</span> <span class="st">&quot;Histogram with the true density curve&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Sample value&quot;</span>)</span>
<span id="cb21-6"><a href="#cb21-6"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x) {<span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)}</span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="kw">curve</span>(f, <span class="dv">-1</span>, <span class="dv">1</span>, <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)    <span class="co"># add the true density curve</span></span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="kw">legend</span>(<span class="fl">0.5</span>,<span class="fl">0.85</span>,<span class="st">&quot;true density&quot;</span>, <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">cex=</span><span class="fl">0.6</span>)    <span class="co"># add a legend</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="exercise-3.10" class="section level2">
<h2>Exercise 3.10</h2>
<div id="problem-2" class="section level3">
<h3>Problem</h3>
<p>Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e\)</span></p>
</div>
<div id="solution-2" class="section level3">
<h3>Solution</h3>
<p>Let <span class="math inline">\(X_1=|U_1|, X_2=|U_2|, X_3=|U_3|\)</span>,then clearly there is <span class="math inline">\(X_1,X_2,X_3 \sim\)</span> Uniform(0,1).</p>
<p>Let <span class="math inline">\(X= \begin{cases} X_2 &amp; ~~X_3 \geq X_1~~and~~ X_3 \geq X_2 \\ X_3 &amp; ~~otherwise \\ \end{cases}\)</span><br />
Then, since <span class="math inline">\(f_e(x)\)</span> is symmetric, all I have to prove is that <span class="math inline">\(X\)</span> obeys the pdf<br />
<span class="math display">\[f_{e&#39;}(x)=2*\frac{3}{4}(1-x^2),~~~~~~~0 \leq x \leq 1\]</span></p>
<p>Now, notice that the algorithm to generate <span class="math inline">\(X\)</span> can be rewritten as:</p>
<ol style="list-style-type: decimal">
<li>Generate <span class="math inline">\(X_1,X_2,X_3 \sim\)</span> Uniform(0,1).<br />
</li>
<li>Remove the largest value <span class="math inline">\(X_{(3)}\)</span><br />
</li>
<li>Select one of the remaining two values with equal probability. Let <span class="math inline">\(X\)</span> be this value.</li>
</ol>
<p>For any <span class="math inline">\(0 \leq x \leq 1\)</span>, consider the events:<br />
<span class="math inline">\(A=\{\)</span> only one of the <span class="math inline">\(X_i \leq x\)</span> <span class="math inline">\(\}\)</span><br />
<span class="math inline">\(B=\{\)</span> at least two of the <span class="math inline">\(X_i \leq x\)</span> <span class="math inline">\(\}\)</span>,<br />
Then, it’s easy to compute the cdf of <span class="math inline">\(X\)</span>, <span class="math inline">\(F_{e&#39;}(x)\)</span> as following:</p>
<p><span class="math display">\[\begin{align}
F_{e&#39;}(x)&amp;=P(X\leq x)\\
&amp;=P(X \leq x,A)+P(X \leq x,B)\\
&amp;=P(X \leq x~|~A)*P(A) + P(X \leq x~|~B)*P(B)\\
&amp;=\frac{1}{2}*3x(1-x)^2 + 1*[3x^2(1-x) + x^3]\\
&amp;=-\frac{1}{2} x^3 +\frac{3}{2}x,~~~~~~0 \leq x \leq 1
\end{align}\]</span></p>
<p>Thus, the pdf of <span class="math inline">\(X\)</span> is <span class="math display">\[ f_{e&#39;}(x)=F&#39;_{e&#39;}(x)=2*\frac{3}{4}(1-x^2),~~~~~~~0 \leq x \leq 1 \]</span></p>
<p>Thus, the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e. ~~~ \Box\)</span></p>
</div>
</div>
<div id="exercise-3.13" class="section level2">
<h2>Exercise 3.13</h2>
<div id="problem-3" class="section level3">
<h3>Problem</h3>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf<br />
<span class="math display">\[F(y)=1-\Big(\frac{\beta}{\beta+y}\Big)^r,~~~~~~~y\geq0\]</span></p>
<p>(This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate 1000 random observations from the mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>. Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="solution-3" class="section level3">
<h3>Solution</h3>
<p>Just do as the problem suggests.<br />
When <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>, the Pareto distribution has a pdf of<br />
<span class="math display">\[f(y)=\frac{64}{(2+y)^5},~~~~~~~y \geq 0 \]</span></p>
</div>
</div>
</div>
<div id="homework-3-2020-10-13" class="section level1">
<h1>Homework 3 (2020-10-13)</h1>
<div id="exercise-5.1" class="section level2">
<h2>Exercise 5.1</h2>
<div id="problem-4" class="section level3">
<h3>Problem</h3>
<p>Compute a Monte Carlo estimate of <span class="math display">\[\int_0^{\pi/3} sin~t~dt\]</span> and compare your estimate with the exact value of the integral.</p>
</div>
<div id="solution-4" class="section level3">
<h3>Solution</h3>
<p>Use the simple Monte Carlo integration. <span class="math display">\[X \sim Uniform(0,\pi/3),~~~g(X)=\pi sin(X)/3\]</span> The exact value is <span class="math display">\[\int_0^{\pi/3} sin~t~dt=cos(0)-cos(\pi/3)=0.5\]</span></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">set.seed</span>(<span class="dv">3333</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a>monte_carlo_rep &lt;-<span class="st"> </span><span class="dv">100000</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>uniform_x &lt;-<span class="st"> </span><span class="kw">runif</span>(monte_carlo_rep,<span class="dv">0</span>,pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb22-4"><a href="#cb22-4"></a>single_estimate &lt;-<span class="st"> </span><span class="kw">sin</span>(uniform_x)<span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>final_estimate &lt;-<span class="st"> </span><span class="kw">mean</span>(single_estimate)</span>
<span id="cb22-6"><a href="#cb22-6"></a>final_estimate</span></code></pre></div>
<pre><code>## [1] 0.5006204</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co">#=0.5006204, very close to the exact value 0.5.</span></span></code></pre></div>
</div>
</div>
<div id="exercise-5.7" class="section level2">
<h2>Exercise 5.7</h2>
<div id="problem-5" class="section level3">
<h3>Problem</h3>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6</p>
</div>
<div id="solution-5" class="section level3">
<h3>Solution</h3>
<p><span class="math display">\[\theta=\int_0^1 e^xdx\]</span> <span class="math display">\[Var(e^U)=E(e^{2U})-(E(e^U))^2=\int_0^1 e^{2x}dx-(\int_0^1 e^{x}dx)^2=\frac{1}{2}(e^2-1)-(e-1)^2=0.2420\]</span> <span class="math display">\[Cov(e^U,e^{1-U})=E(e^{U+1-U)})-E(e^U)E(e^{1-U})=e-\int_0^1e^xdx \int_0^1e^{1-x}dx=-0.2342\]</span> <span class="math display">\[Var((e^U+e^{1-U})/2)=Var(e^U)/4+Var(e^{1-U})/4+Cov(e^U,e^{1-U})/2=0.0039\]</span></p>
<p>Thus, the theoretical value of percent reduction is <span class="math inline">\(1-0.0039/0.2420=98.39\%\)</span></p>
<p>Next, we could compute an empirical estimate of the percent reduction in variance by the Monte Carlo simulation.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">set.seed</span>(<span class="dv">2222</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a>monte_carlo_r &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>var_reduc_store &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,monte_carlo_r)</span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>monte_carlo_r){</span>
<span id="cb25-5"><a href="#cb25-5"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10000</span>)</span>
<span id="cb25-6"><a href="#cb25-6"></a>  simple_mc &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">^</span>u</span>
<span id="cb25-7"><a href="#cb25-7"></a>  antithetic &lt;-<span class="st"> </span>(<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">^</span>u<span class="op">+</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">-</span>u))<span class="op">/</span><span class="dv">2</span></span>
<span id="cb25-8"><a href="#cb25-8"></a>  var_reduc_store[i] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="st"> </span><span class="kw">var</span>(antithetic) <span class="op">/</span><span class="st"> </span><span class="kw">var</span>(simple_mc)</span>
<span id="cb25-9"><a href="#cb25-9"></a>}</span>
<span id="cb25-10"><a href="#cb25-10"></a><span class="kw">mean</span>(var_reduc_store)</span></code></pre></div>
<pre><code>## [1] 0.983845</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># empirical estimate of the percent reduction is 98.38%, very close to the theoretical value 98.39%.</span></span></code></pre></div>
</div>
</div>
<div id="exercise-5.11" class="section level2">
<h2>Exercise 5.11</h2>
<div id="problem-6" class="section level3">
<h3>Problem</h3>
<p>If <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span> are antithetic, we derived that <span class="math inline">\(c^*=1/2\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat{\theta}_c=c \hat{\theta}_1+(1-c)\hat{\theta}_2\)</span>. Derive <span class="math inline">\(c^*\)</span> for the general case. That is , if <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, find the value <span class="math inline">\(c^*\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat{\theta}_c=c \hat{\theta}_1+(1-c)\hat{\theta}_2\)</span>.</p>
</div>
<div id="solution-6" class="section level3">
<h3>Solution</h3>
<p><span class="math display">\[\begin{align}
Var(\hat{\theta}_c) &amp;= Var(c \hat{\theta}_1+(1-c)\hat{\theta}_2)\\
&amp;=c^2 Var(\hat{\theta}_1) + (1-c)^2 Var(\hat{\theta}_2) + 2c(1-c) Cov(\hat{\theta}_1,\hat{\theta}_2)\\
&amp;=(Var(\hat{\theta}_1)+Var(\hat{\theta}_2)-2Cov(\hat{\theta}_1,\hat{\theta}_2))c^2+(2Cov(\hat{\theta}_1,\hat{\theta}_2)-2Var(\hat{\theta}_2))c+Var(\hat{\theta}_2)\\
&amp;=(Var(\hat{\theta}_1)+Var(\hat{\theta}_2)-2Cov(\hat{\theta}_1,\hat{\theta}_2))(c+\frac{Cov(\hat{\theta}_1,\hat{\theta}_2)-Var(\hat{\theta}_2)}{Var(\hat{\theta}_1)+Var(\hat{\theta}_2)-2Cov(\hat{\theta}_1,\hat{\theta}_2)})^2+K
\end{align}\]</span> ,where K is the remaining item irrelevant to c. </p>
<p>In addition, we know that <span class="math inline">\(0 \leq c \leq 1\)</span>,</p>
<p>Thus, to minimize the variance, <span class="math inline">\(c*= \begin{cases} 0 &amp; ~~~~ \frac{Var(\hat{\theta}_2)-Cov(\hat{\theta}_1,\hat{\theta}_2)}{Var(\hat{\theta}_1)+Var(\hat{\theta}_2)-2Cov(\hat{\theta}_1,\hat{\theta}_2)} &lt;0\\ \frac{Var(\hat{\theta}_2)-Cov(\hat{\theta}_1,\hat{\theta}_2)}{Var(\hat{\theta}_1)+Var(\hat{\theta}_2)-2Cov(\hat{\theta}_1,\hat{\theta}_2)} &amp;~~~~ 0 \leq \frac{Var(\hat{\theta}_2)-Cov(\hat{\theta}_1,\hat{\theta}_2)}{Var(\hat{\theta}_1)+Var(\hat{\theta}_2)-2Cov(\hat{\theta}_1,\hat{\theta}_2)} \leq 1 \\ 1 &amp; ~~~~ \frac{Var(\hat{\theta}_2)-Cov(\hat{\theta}_1,\hat{\theta}_2)}{Var(\hat{\theta}_1)+Var(\hat{\theta}_2)-2Cov(\hat{\theta}_1,\hat{\theta}_2)} &gt;1\\ \end{cases}\)</span></p>
<p><span class="math inline">\(\Box\)</span></p>
</div>
</div>
</div>
<div id="homework-4-2020-10-20" class="section level1">
<h1>Homework 4 (2020-10-20)</h1>
<div id="exercise-5.13" class="section level2">
<h2>Exercise 5.13</h2>
<div id="problem-7" class="section level3">
<h3>Problem</h3>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}} e^{-x^2/2},~~~~x&gt;1\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_1^{\infty} \frac{x^2}{\sqrt{2\pi}}e^{-x^2/2} dx\]</span> by importance sampling? Explain.</p>
</div>
<div id="solution-7" class="section level3">
<h3>Solution</h3>
<p>Considering the properties of the integrand, I find two functions that are ‘close’ to the integrand and are supported on <span class="math inline">\((1,\infty)\)</span>. They are <span class="math inline">\(e^{-x/2}\)</span> and <span class="math inline">\(e^{-(x-1)}\)</span>. To make them density functions, they need to be multiplied by a constant.</p>
<p><span class="math display">\[f_1(x)=\frac{\sqrt{e}}{2}e^{-x/2},~~~~x&gt;1\]</span> <span class="math display">\[f_2(x)=e^{-(x-1)},~~~~x&gt;1\]</span></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">set.seed</span>(<span class="dv">3333</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x) x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)</span>
<span id="cb28-3"><a href="#cb28-3"></a>f1 &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">sqrt</span>(<span class="kw">exp</span>(<span class="dv">1</span>))<span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb28-4"><a href="#cb28-4"></a>f2 &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span>(x<span class="dv">-1</span>))</span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="kw">plot</span>(g,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ylab=</span><span class="st">&#39;y&#39;</span>)</span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="kw">par</span>(<span class="dt">new=</span><span class="ot">TRUE</span>)</span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="kw">plot</span>(f1,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dt">xlab=</span><span class="st">&#39;&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;&#39;</span>,<span class="dt">main=</span><span class="st">&#39;&#39;</span>,<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb28-8"><a href="#cb28-8"></a><span class="kw">par</span>(<span class="dt">new=</span><span class="ot">TRUE</span>)</span>
<span id="cb28-9"><a href="#cb28-9"></a><span class="kw">plot</span>(f2,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dt">xlab=</span><span class="st">&#39;&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;&#39;</span>,<span class="dt">main=</span><span class="st">&#39;&#39;</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb28-10"><a href="#cb28-10"></a><span class="kw">legend</span>(<span class="dv">4</span>,<span class="fl">0.9</span>,<span class="kw">c</span>(<span class="st">&quot;g&quot;</span>,<span class="st">&quot;f1&quot;</span>,<span class="st">&quot;f2&quot;</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&#39;black&#39;</span>,<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;red&#39;</span>),<span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the figure, it seems that the most nearly constant ratio <span class="math inline">\(g(x)/f(x)\)</span> appears to be <span class="math inline">\(f_2\)</span>. Thus, I might prefer <span class="math inline">\(f_2\)</span> for the smallest variance.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">set.seed</span>(<span class="dv">3333</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>m &lt;-<span class="st"> </span><span class="dv">100000</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>se &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb29-4"><a href="#cb29-4"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb29-5"><a href="#cb29-5"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x) x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)</span>
<span id="cb29-6"><a href="#cb29-6"></a>f1 &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">sqrt</span>(<span class="kw">exp</span>(<span class="dv">1</span>))<span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb29-7"><a href="#cb29-7"></a>f2 &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span>(x<span class="dv">-1</span>))</span>
<span id="cb29-8"><a href="#cb29-8"></a></span>
<span id="cb29-9"><a href="#cb29-9"></a>u1 &lt;-<span class="st"> </span><span class="kw">runif</span>(m,<span class="dv">0</span>,<span class="fl">0.5</span>)    <span class="co"># to confirm that all the x1&gt;1</span></span>
<span id="cb29-10"><a href="#cb29-10"></a>x1 &lt;-<span class="st"> </span><span class="dv">-2</span><span class="op">*</span><span class="kw">log</span>(u1 <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">exp</span>(<span class="dv">1</span>)))    <span class="co"># f1, using inverse transform method</span></span>
<span id="cb29-11"><a href="#cb29-11"></a>f1g &lt;-<span class="st"> </span><span class="kw">g</span>(x1)<span class="op">/</span><span class="kw">f1</span>(x1)</span>
<span id="cb29-12"><a href="#cb29-12"></a>theta.hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(f1g)</span>
<span id="cb29-13"><a href="#cb29-13"></a>se[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(f1g)</span>
<span id="cb29-14"><a href="#cb29-14"></a></span>
<span id="cb29-15"><a href="#cb29-15"></a>x2 &lt;-<span class="st"> </span><span class="kw">rexp</span>(m)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb29-16"><a href="#cb29-16"></a>f2g &lt;-<span class="st"> </span><span class="kw">g</span>(x2)<span class="op">/</span><span class="kw">f2</span>(x2)</span>
<span id="cb29-17"><a href="#cb29-17"></a>theta.hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(f2g)</span>
<span id="cb29-18"><a href="#cb29-18"></a>se[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(f2g)</span>
<span id="cb29-19"><a href="#cb29-19"></a></span>
<span id="cb29-20"><a href="#cb29-20"></a>theta.hat</span></code></pre></div>
<pre><code>## [1] 0.4014080 0.4002661</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># 0.4014080 0.4002661, both are close to the real value.</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>se</span></code></pre></div>
<pre><code>## [1] 0.302011 0.157805</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># 0.302011 0.157805, f2 has smaller standard error, as I expected.</span></span></code></pre></div>
</div>
</div>
<div id="exercise-5.15" class="section level2">
<h2>Exercise 5.15</h2>
<div id="problem-8" class="section level3">
<h3>Problem</h3>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="solution-8" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw">set.seed</span>(<span class="dv">3333</span>)</span>
<span id="cb34-2"><a href="#cb34-2"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb34-3"><a href="#cb34-3"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb34-4"><a href="#cb34-4"></a>f1 &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">5</span>))</span>
<span id="cb34-5"><a href="#cb34-5"></a>f2 &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">2</span><span class="op">/</span><span class="dv">5</span>))</span>
<span id="cb34-6"><a href="#cb34-6"></a>f3 &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">2</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">3</span><span class="op">/</span><span class="dv">5</span>))</span>
<span id="cb34-7"><a href="#cb34-7"></a>f4 &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">3</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">4</span><span class="op">/</span><span class="dv">5</span>))</span>
<span id="cb34-8"><a href="#cb34-8"></a>f5 &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">4</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb34-9"><a href="#cb34-9"></a></span>
<span id="cb34-10"><a href="#cb34-10"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)</span>
<span id="cb34-11"><a href="#cb34-11"></a>x1 &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u<span class="op">*</span>((<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">5</span>))))</span>
<span id="cb34-12"><a href="#cb34-12"></a>x2 &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span>u<span class="op">*</span>((<span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">2</span><span class="op">/</span><span class="dv">5</span>))))</span>
<span id="cb34-13"><a href="#cb34-13"></a>x3 &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">2</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span>u<span class="op">*</span>((<span class="kw">exp</span>(<span class="op">-</span><span class="dv">2</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">3</span><span class="op">/</span><span class="dv">5</span>))))</span>
<span id="cb34-14"><a href="#cb34-14"></a>x4 &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">3</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span>u<span class="op">*</span>((<span class="kw">exp</span>(<span class="op">-</span><span class="dv">3</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">4</span><span class="op">/</span><span class="dv">5</span>))))</span>
<span id="cb34-15"><a href="#cb34-15"></a>x5 &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">4</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span>u<span class="op">*</span>((<span class="kw">exp</span>(<span class="op">-</span><span class="dv">4</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))))</span>
<span id="cb34-16"><a href="#cb34-16"></a></span>
<span id="cb34-17"><a href="#cb34-17"></a>fg1 &lt;-<span class="st"> </span><span class="kw">g</span>(x1)<span class="op">/</span><span class="kw">f1</span>(x1)</span>
<span id="cb34-18"><a href="#cb34-18"></a>fg2 &lt;-<span class="st"> </span><span class="kw">g</span>(x2)<span class="op">/</span><span class="kw">f2</span>(x2)</span>
<span id="cb34-19"><a href="#cb34-19"></a>fg3 &lt;-<span class="st"> </span><span class="kw">g</span>(x3)<span class="op">/</span><span class="kw">f3</span>(x3)</span>
<span id="cb34-20"><a href="#cb34-20"></a>fg4 &lt;-<span class="st"> </span><span class="kw">g</span>(x4)<span class="op">/</span><span class="kw">f4</span>(x4)</span>
<span id="cb34-21"><a href="#cb34-21"></a>fg5 &lt;-<span class="st"> </span><span class="kw">g</span>(x5)<span class="op">/</span><span class="kw">f5</span>(x5)</span>
<span id="cb34-22"><a href="#cb34-22"></a></span>
<span id="cb34-23"><a href="#cb34-23"></a>fg &lt;-<span class="st"> </span>fg1<span class="op">+</span>fg2<span class="op">+</span>fg3<span class="op">+</span>fg4<span class="op">+</span>fg5</span>
<span id="cb34-24"><a href="#cb34-24"></a></span>
<span id="cb34-25"><a href="#cb34-25"></a><span class="kw">mean</span>(fg)</span></code></pre></div>
<pre><code>## [1] 0.5248477</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># 0.5248477, very close to the result in Example 5.10</span></span>
<span id="cb36-2"><a href="#cb36-2"></a></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="kw">sd</span>(fg)</span></code></pre></div>
<pre><code>## [1] 0.01694816</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># 0.01694816, much smaller than the result in Example 5.10</span></span></code></pre></div>
</div>
</div>
<div id="exercise-6.4" class="section level2">
<h2>Exercise 6.4</h2>
<div id="problem-9" class="section level3">
<h3>Problem</h3>
<p>Suppose that <span class="math inline">\(X_1,...,X_n\)</span> are a random sample from a from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
</div>
<div id="solution-9" class="section level3">
<h3>Solution</h3>
<p>Set <span class="math inline">\(n=100, m=100, \mu=5, \sigma=1\)</span></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">library</span>(stats)</span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="kw">set.seed</span>(<span class="dv">3333</span>)</span>
<span id="cb39-3"><a href="#cb39-3"></a>n &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb39-4"><a href="#cb39-4"></a>m &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb39-5"><a href="#cb39-5"></a>l_bound &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb39-6"><a href="#cb39-6"></a>u_bound &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb39-7"><a href="#cb39-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) {</span>
<span id="cb39-8"><a href="#cb39-8"></a>  x &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(n,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb39-9"><a href="#cb39-9"></a>  mu_hat &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">log</span>(x))<span class="op">/</span>n</span>
<span id="cb39-10"><a href="#cb39-10"></a>  q &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="fl">-0.05</span><span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)</span>
<span id="cb39-11"><a href="#cb39-11"></a>  sigmasqu_hat &lt;-<span class="st"> </span><span class="kw">sum</span>((<span class="kw">log</span>(x)<span class="op">-</span>mu_hat)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>n</span>
<span id="cb39-12"><a href="#cb39-12"></a>  se_hat &lt;-<span class="st"> </span>sigmasqu_hat<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb39-13"><a href="#cb39-13"></a>  l_bound[i] &lt;-<span class="st"> </span>mu_hat <span class="op">-</span><span class="st"> </span>q<span class="op">*</span>se_hat</span>
<span id="cb39-14"><a href="#cb39-14"></a>  u_bound[i] &lt;-<span class="st"> </span>mu_hat <span class="op">+</span><span class="st"> </span>q<span class="op">*</span>se_hat</span>
<span id="cb39-15"><a href="#cb39-15"></a>}</span>
<span id="cb39-16"><a href="#cb39-16"></a>lb &lt;-<span class="st"> </span><span class="kw">mean</span>(l_bound)</span>
<span id="cb39-17"><a href="#cb39-17"></a>ub &lt;-<span class="st"> </span><span class="kw">mean</span>(u_bound)</span>
<span id="cb39-18"><a href="#cb39-18"></a><span class="kw">c</span>(lb,ub)</span></code></pre></div>
<pre><code>## [1] 4.808141 5.199664</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># an empirical estimate of the confidence level is [4.808141, 5.199664], while the true value is 5.</span></span></code></pre></div>
</div>
</div>
<div id="exercise-6.5" class="section level2">
<h2>Exercise 6.5</h2>
<div id="problem-10" class="section level3">
<h3>Problem</h3>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n = 20\)</span>. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="solution-10" class="section level3">
<h3>Solution</h3>
<p>Random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n = 20\)</span> is non-normal, while the random samples in Example 6.4 is normal with mean=0 and sd=2.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="kw">set.seed</span>(<span class="dv">3333</span>)</span>
<span id="cb42-2"><a href="#cb42-2"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb42-3"><a href="#cb42-3"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb42-4"><a href="#cb42-4"></a>lb_non &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb42-5"><a href="#cb42-5"></a>ub_non &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb42-6"><a href="#cb42-6"></a>lb_nor &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb42-7"><a href="#cb42-7"></a>ub_nor &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb42-8"><a href="#cb42-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb42-9"><a href="#cb42-9"></a>  non_normal_x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb42-10"><a href="#cb42-10"></a>  lb_non[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(non_normal_x) <span class="op">-</span><span class="st"> </span><span class="kw">sd</span>(non_normal_x)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="fl">-0.05</span><span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb42-11"><a href="#cb42-11"></a>  ub_non[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(non_normal_x) <span class="op">+</span><span class="st"> </span><span class="kw">sd</span>(non_normal_x)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="fl">-0.05</span><span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb42-12"><a href="#cb42-12"></a>  normal_x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">2</span>)</span>
<span id="cb42-13"><a href="#cb42-13"></a>  lb_nor[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(normal_x) <span class="op">-</span><span class="st"> </span><span class="kw">sd</span>(normal_x)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="fl">-0.05</span><span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb42-14"><a href="#cb42-14"></a>  ub_nor[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(normal_x) <span class="op">+</span><span class="st"> </span><span class="kw">sd</span>(normal_x)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="fl">-0.05</span><span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb42-15"><a href="#cb42-15"></a>}</span>
<span id="cb42-16"><a href="#cb42-16"></a>cov_prob_non &lt;-<span class="st"> </span><span class="kw">mean</span>(lb_non<span class="op">&lt;</span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span>ub_non<span class="op">&gt;</span><span class="dv">2</span>)</span>
<span id="cb42-17"><a href="#cb42-17"></a>cov_prob_nor &lt;-<span class="st"> </span><span class="kw">mean</span>(lb_nor<span class="op">&lt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>ub_nor<span class="op">&gt;</span><span class="dv">0</span>)</span>
<span id="cb42-18"><a href="#cb42-18"></a><span class="kw">c</span>(cov_prob_non,cov_prob_nor)</span></code></pre></div>
<pre><code>## [1] 0.9173 0.9490</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co"># The normal samples have a coverage probability of 94.9%, which is effective. However, the non-normal samples only have a coverage probability of 91.73%, which suggests that the probability that the confidence interval covers the mean is not necessarily equal to 0.95 for non-normal samples.</span></span></code></pre></div>
</div>
</div>
</div>
<div id="homework-5-2020-10-27" class="section level1">
<h1>Homework 5 (2020-10-27)</h1>
<div id="exercise-6.7" class="section level2">
<h2>Exercise 6.7</h2>
<div id="problem-11" class="section level3">
<h3>Problem</h3>
<p>Estimate the power of the skewness test of normality against symmetric Beta(<span class="math inline">\(\alpha,\alpha\)</span>) distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as t(<span class="math inline">\(\nu\)</span>)?</p>
</div>
<div id="solution-11" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">set.seed</span>(<span class="dv">3333</span>)</span>
<span id="cb45-2"><a href="#cb45-2"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb45-3"><a href="#cb45-3"></a>  <span class="co"># skewness computation</span></span>
<span id="cb45-4"><a href="#cb45-4"></a>  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb45-5"><a href="#cb45-5"></a>  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb45-6"><a href="#cb45-6"></a>  m3<span class="op">/</span>(m2<span class="op">*</span><span class="kw">sqrt</span>(m2))</span>
<span id="cb45-7"><a href="#cb45-7"></a>}</span>
<span id="cb45-8"><a href="#cb45-8"></a></span>
<span id="cb45-9"><a href="#cb45-9"></a>n &lt;-<span class="st"> </span><span class="dv">40</span></span>
<span id="cb45-10"><a href="#cb45-10"></a>m &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb45-11"><a href="#cb45-11"></a>alpha_test &lt;-<span class="st"> </span><span class="fl">0.1</span>    <span class="co"># confidence level alpha</span></span>
<span id="cb45-12"><a href="#cb45-12"></a>alpha &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>),<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.5</span>))    <span class="co"># parameter alpha for symmetric Beta distribution</span></span>
<span id="cb45-13"><a href="#cb45-13"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(alpha)</span>
<span id="cb45-14"><a href="#cb45-14"></a>powerrate &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb45-15"><a href="#cb45-15"></a>critical_value &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha_test<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>((n<span class="dv">-2</span>)<span class="op">*</span><span class="dv">6</span> <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">3</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">1</span>))))</span>
<span id="cb45-16"><a href="#cb45-16"></a></span>
<span id="cb45-17"><a href="#cb45-17"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb45-18"><a href="#cb45-18"></a>  test_rej &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb45-19"><a href="#cb45-19"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb45-20"><a href="#cb45-20"></a>    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,alpha[i],alpha[i])</span>
<span id="cb45-21"><a href="#cb45-21"></a>    test_rej[j] &lt;-<span class="st"> </span>(critical_value <span class="op">&lt;=</span><span class="st"> </span><span class="kw">abs</span>(<span class="kw">sk</span>(x)))</span>
<span id="cb45-22"><a href="#cb45-22"></a>  }</span>
<span id="cb45-23"><a href="#cb45-23"></a>  powerrate[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(test_rej)</span>
<span id="cb45-24"><a href="#cb45-24"></a>}</span>
<span id="cb45-25"><a href="#cb45-25"></a></span>
<span id="cb45-26"><a href="#cb45-26"></a><span class="kw">plot</span>(alpha,powerrate,<span class="dt">xlab=</span><span class="kw">bquote</span>(alpha),<span class="dt">type=</span><span class="st">&#39;b&#39;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb45-27"><a href="#cb45-27"></a><span class="kw">abline</span>(<span class="dt">h =</span> alpha_test, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb45-28"><a href="#cb45-28"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(powerrate<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>powerrate)<span class="op">/</span>m)    <span class="co"># add standard errors</span></span>
<span id="cb45-29"><a href="#cb45-29"></a><span class="kw">lines</span>(alpha, powerrate<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb45-30"><a href="#cb45-30"></a><span class="kw">lines</span>(alpha, powerrate<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAJACAMAAABSRCkEAAAAb1BMVEUAAAAAADoAAGYAOjoAOpAAZpAAZrY6AAA6ADo6AGY6ZpA6kNtmAABmADpmZmZmZrZmtv+QOgCQOjqQZgCQZmaQ29uQ2/+2ZgC2Zjq22/+2/7a2///bkDrb////tmb/tpD/25D/27b//7b//9v////WLSq5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAO9ElEQVR4nO3dD0PiSIKH4XSva++e7F27d9feXSPrIN//Mx4Q5J8EJb+UFJnnme1eRzGovFaqEiY0Cwg01/4CuG0CIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAwfUMBLXCmjYzXEtAiIiICICIlIooNfHdob1/fcgm6NaZQKaNg/tG7O3N6LNUa8iAb0+brOZ3j3Hm6NiRQKaT36+vTnr2IkJaCSMQERKzYE2Q5A50NgVWoXNJ+0qrGP8EdBoOA5EREBESgc0tQobty8egS5/FgB1swsjIiAiAiIiICKFzoXtJstWYeNWZgR6fex8IlCfzVGvYk8oux9yc1Sr1Bxo1vw8+3EBjYRJNBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREJFCAT01zf3rY9N0vnq8gEaiTEDTu+dlQ/eLxXzyMMDmqFeRgF4fl9nMvv1atCmlm6NiRQKaT5Z7rtn334u3v7PNUTEjEJHCc6B1SvHmqJdVGBHHgYgIiEjpgKZWYeP2xSNQszXI5rg6uzAiAiJSKKD1En6pYwYkoNEodCCx2Rw/nDUOJI5buVMZLacyRq7cydSWk6kjZwQiUmoOtBmCzIHGrtAqbD5pV2Ed44+ARsNxICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiJSKKCn778XLz+a5tuvQTZHtcoEtO7nb79Wrx//c4DNUa8iAc0nD8uI7ldvTu+e481RsUIB/Vy8Pj6s3pwtx6J0c1Ss0C5sOfpMjUB/BmUCmk++/14PQbOuWbSARqLUMn7WrN0PtDlq5TgQEQERKR3Q1Cps3L54BGq2BtkcV2cXRkRARPoENJ80d89PD+du/frY7qg6ZkACGo0eAc2+/ZrePa/Pd3WZNpsPzpqOWwloJC4PaHWEeXWComt9tbnJhlMZI3d5QKszpassuk6TLg6exOFk6sj1H4GeOsaWhRHoz6T3HGjadDxVbGX7QXOgseu5CjvzZNXdTZY6RykBjYTjQER6TKL/0Y49ZybRQ94vdesf0Jll/JD3S90uDehpdzr07KHowe6XuvUfgb7ofqmbSTSRHgG9LdHNgegV0NPd8/R+8fLjzIHEAe+XuvU5F/awmK1Opnafyhjyfqlbv5OpL3//vf7zBfdL3fqdTF2txATEotccaHUE8enBLoyVPsv4p/vVSixahAloLBwHItJvDvSF90vd+q3CvvB+qVufZyRms58L75e69RmBGqcyeGMSTcQkmohJNBGTaCIm0URMookIiEih6wMNd7/Urcz1gQa8X+pW5PpAQ94vdStyfaAh75e6Fbk+0JD3S93KXB9owPulboWuDzTc/VI3x4GICIhIr3Nhna8CVuB+qVv/iytkkyABjUTvXdjqVS2/4n6pW7+AVoOQEYhFr4BefoTPBbrofqlbn0m0ZySy1WcXthyC4nWYgEai5yR62mRnMgQ0FlZhRPpcI9GT6tnqdSQ6PJF60f1SN+fCiPRchXk6B60+Tyhbv0qGJ5Sx0v/iCi6yySK5uIIn1bMwAhEyByJiFUbEcSAiRQM685JQAhqJ3v9d2Lkp9PYaVN1nzAQ0Ev3+y9Tl39Nzk6B2nm0E+hPos4xvqzj738bPJ6uPCmj8ehxI3Lxq8wcHEp+WI5SAxq//CPTRgcRp8yCg8et1IHGVxccHEl9+/EVAoxdc5vfDJyW+PnZHJqCRcCCRSOmAuq6kKKCR+OIRaLf3G2RzXJ1dGBEBESkU0HIBdn6ZJqCRKBPQtNlcxn7WdFzPXkAjUSSgvRc17DpeLaCRKBLQ3osadp0xE9BIGIGIlJoDbYYgc6CxK7QKezth1nnGXkAj4TgQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBESkU0LRp2peOn37/PcDmqFaZgKbffi3mk/uFgEavSECvjw/rv++eBTR2RQKaT9a7r8XT3bOARq7gCLT0dC+gkSs0B9pkM580Ahq3Yquwdif2+iigcXMciIiAiJQOyCR65L54BGq2BtkcV2cXRkRARAoF9PrY7qg6ZkACGo1CBxKbzaHo2dsb0eaoV9lTGcuU7p7jzVGxoidTl2aW8eNmBCJSag60GYLMgcau0CpsPmlXYR3jj4BGw3EgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiVwuo8Wcsf64T0LCb41oERERARAREREBEagnIix/cqEoCatb/cHvqCKhZLBR0m+oJyLzoBryfaQiIz2sWJyYfF3zuwF/Kwb82FxwVZ1ifWsE0p3/PKwlo/T1YiV1H+7M/e4v9wafOgBYnx0eKe/ut7Twz2uwelboDshL7UrtgDrPYvn89Lm3e/1ZWvXOgxSYeO7HCmvcjzekVTLMbeZrd/9e6CmvfYx/2sQvmiSce7P0Edh/ea2r7csjHVXXebT0Bve3DDEJnNNsZ7/6P6eTPrNn92e2Wth/Zferu8/cGnYNbnn1EKgroba9rFDppb5jYvqvZ7le2u6bDP0eTyr3PPzdn3luxf/jrXFNAi7cp/0gK+vxg+sEtt4/oyelKxxxm/+/9SfDhSHP2Lj/z5dcX0GiWYrvdzcF7373jaNQ4uuXBzQ9aOTldOW5lt7HdYPXJL/9z+VcY0AhGoKPdTXP47wfva46/6aOg2vftz3yPF1Lvfmbbvddnp0uJygKqfw50+hE4WtKs31js/t671cGSZ7F4d8uOZdD+tOb9+040V6CVk2oLaLeQvL7m8Ff3xIR1+8HFbtQ5lcXJHctRHEejxd4nfjyRveKPrLqA3uYO13dqH3D80L8fGrYDyfndzcGIcTTs7n2shp/DeRUG1P48rx3RcQ+fnLDuB3Nud3N8Z++/2ep35q0KA2p/na/563fioNveHqxr7vG55Adb21eiUECvj+3Lfn//ffnmmt0/p36XizicBL99GSdGjNPjwo2MFiWUCWjaPLRvzN7euGBz271/O0/dDEZFH5+9SXCzPfzS0coHq7A/myIBvT5us5nePV+8ud0+7C2kzayo/Wj4WJ34/L1JcNcchg5FAppPfr69OevYiZ3dXNNsH9LtbGj7LxdMr8/NTQ8mMJ235iM1jkDtDd52YNtJ0eZ/zaefPX2wDzqeBS92K72bWTLXqNQcaDME9ZkDHdym2Xvg9/Zp7297/L79Yzh7o9Z2bXUwQf4TT4JThVZh80m7r+kYfz65ue3zO3azoO3ctuko4PB9e+vw/U95N9zYffVVKKABN9dsc9idIGy2A8vmJnsHYpr9QetomrMw2Ayt/oC2n7HrY/+4zDasTx+zMdgMqXRA0z6rsO4vouOA7+He6uDmlPXFI9B2IV5gQBPLNdzOLuyD7RlsrmMsAXElhQJKTqZyS0odSAxOpnJLqj2VwW2o8mQqt8MIRKTmk6ncgKpPplI/x4GICIiIgIgIiIiAiFwtIEbiSgF9zfZLbPRmvtDKvnsBFdzm7WxUQFVu83Y2KqAqt3k7GxVQldu8nY0KqMpt3s5GBVTlNm9nowKqcpu3s1EBVbnN29lovQExcgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIkUDmjXNt18Db3N9lb2Oa4MknjovGNHXy4+muR94m4vp8rv/+fHNLvDy9/Wlnvo+ViUDmi2/otnABb0+Ljc4Hf6BmXVfcaTvFpcbnE8G/kKnqx/poAXNJ+trhfV+rAoG1F6P6mnYH+HLj9VPr+s6573NJ0MH1H73A3+hr4+rn+aQP9JZe8XU/o9VwYAKPdYrQ49ri+ndfw4c0Mvfht55LwoENGse1lcr7P9YlQxo/SPsuppi5GngjS6/1KHnQLPv/zcZfrI2/C6sfYD6P1YFA2qHicEHi8WZK+z1tBrAhw5outo1tCPGkIZfl6yr6f9Y3WJAs6Hn0KtLhg4e0LcS4+9q6H35MeivT70BldqFDT3+tF/o4AGtv+92bjGYEtPKendhhSbR0+EnFpsrmgw/tRh6Kl1iUK93El1kGb+71PDAhh6B2quyDzz+to/zsBudVbuML3IgceAJwM7gR6JXE6u9S7MPo9QcqMoDiet9w+AHbNq9zfAz8+FPZcxKnHN5Gnyjm/Gs72PlZCoRAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAV3k9X+abz/X146iJaCLLNP545//PfR1x26ZgC6xvvDh/N9LXIT+VgnoEu1FV4e/Gt4NE9Al1i+NNPzl52+ZgC4x/8evgheKvUkCusjTX5//ePzrf/3vH/9x7a+kFgK6yHIZ3/zb879+FHgFmRslICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiLy/72EMjVdbz2sAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>nu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="fl">0.1</span>),<span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">20</span>,<span class="dv">1</span>))    <span class="co"># paramer nu for t distribution</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>N_t &lt;-<span class="st"> </span><span class="kw">length</span>(nu)</span>
<span id="cb46-3"><a href="#cb46-3"></a>powerrate_t &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N_t)</span>
<span id="cb46-4"><a href="#cb46-4"></a></span>
<span id="cb46-5"><a href="#cb46-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N_t) {</span>
<span id="cb46-6"><a href="#cb46-6"></a>  test_rej &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb46-7"><a href="#cb46-7"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb46-8"><a href="#cb46-8"></a>    x &lt;-<span class="st"> </span><span class="kw">rt</span>(n,nu[i])</span>
<span id="cb46-9"><a href="#cb46-9"></a>    test_rej[j] &lt;-<span class="st"> </span>(critical_value <span class="op">&lt;=</span><span class="st"> </span><span class="kw">abs</span>(<span class="kw">sk</span>(x)))</span>
<span id="cb46-10"><a href="#cb46-10"></a>  }</span>
<span id="cb46-11"><a href="#cb46-11"></a>  powerrate_t[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(test_rej)</span>
<span id="cb46-12"><a href="#cb46-12"></a>}</span>
<span id="cb46-13"><a href="#cb46-13"></a></span>
<span id="cb46-14"><a href="#cb46-14"></a><span class="kw">plot</span>(nu,powerrate_t,<span class="dt">xlab=</span><span class="kw">bquote</span>(nu),<span class="dt">type=</span><span class="st">&#39;b&#39;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb46-15"><a href="#cb46-15"></a><span class="kw">abline</span>(<span class="dt">h =</span> alpha_test, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb46-16"><a href="#cb46-16"></a>se_t &lt;-<span class="st"> </span><span class="kw">sqrt</span>(powerrate_t<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>powerrate_t)<span class="op">/</span>m)    <span class="co"># add standard errors</span></span>
<span id="cb46-17"><a href="#cb46-17"></a><span class="kw">lines</span>(nu, powerrate_t<span class="op">+</span>se_t, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb46-18"><a href="#cb46-18"></a><span class="kw">lines</span>(nu, powerrate_t<span class="op">-</span>se_t, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># The result of heavy-tailed symmetric distribution (such as t-distribution) and light-tailed symmetric distribution (such as beta-distribution with alpha&gt;1) are significantly different! Heavy-tailed symmetric distribution has higher power, while light-tailed symmetric distribution has very low power.</span></span></code></pre></div>
</div>
</div>
<div id="exercise-6.8" class="section level2">
<h2>Exercise 6.8</h2>
<div id="problem-12" class="section level3">
<h3>Problem</h3>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F test of equal variance, at significance level <span class="math inline">\(\hat{\alpha}=0.055\)</span>. Compare the power of the Count Five test and F test for small, medium, and large sample sizes. (Recall that the F test is not applicable for non-normal distributions.)</p>
</div>
<div id="solution-12" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="kw">set.seed</span>(<span class="dv">3333</span>)</span>
<span id="cb48-2"><a href="#cb48-2"></a></span>
<span id="cb48-3"><a href="#cb48-3"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb48-4"><a href="#cb48-4"></a>  x_central &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb48-5"><a href="#cb48-5"></a>  y_central &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb48-6"><a href="#cb48-6"></a>  x_outlier &lt;-<span class="st"> </span><span class="kw">sum</span>(x_central <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(y_central)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(x_central <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(y_central))</span>
<span id="cb48-7"><a href="#cb48-7"></a>  y_outlier &lt;-<span class="st"> </span><span class="kw">sum</span>(y_central <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(x_central)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(y_central <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(x_central))</span>
<span id="cb48-8"><a href="#cb48-8"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb48-9"><a href="#cb48-9"></a>  <span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(x_outlier,y_outlier)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>)</span>
<span id="cb48-10"><a href="#cb48-10"></a>}</span>
<span id="cb48-11"><a href="#cb48-11"></a></span>
<span id="cb48-12"><a href="#cb48-12"></a>n_small &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb48-13"><a href="#cb48-13"></a>n_medium &lt;-<span class="st"> </span><span class="dv">80</span></span>
<span id="cb48-14"><a href="#cb48-14"></a>n_large &lt;-<span class="st"> </span><span class="dv">200</span></span>
<span id="cb48-15"><a href="#cb48-15"></a><span class="co"># small, medium and large sample sizes</span></span>
<span id="cb48-16"><a href="#cb48-16"></a></span>
<span id="cb48-17"><a href="#cb48-17"></a>m &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb48-18"><a href="#cb48-18"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb48-19"><a href="#cb48-19"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb48-20"><a href="#cb48-20"></a><span class="co"># generate samples under H1 to estimate power</span></span>
<span id="cb48-21"><a href="#cb48-21"></a></span>
<span id="cb48-22"><a href="#cb48-22"></a>power_s_c5 &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb48-23"><a href="#cb48-23"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n_small, <span class="dv">0</span>, sigma1)</span>
<span id="cb48-24"><a href="#cb48-24"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n_small, <span class="dv">0</span>, sigma2)</span>
<span id="cb48-25"><a href="#cb48-25"></a><span class="kw">count5test</span>(x, y)</span>
<span id="cb48-26"><a href="#cb48-26"></a>}))</span>
<span id="cb48-27"><a href="#cb48-27"></a></span>
<span id="cb48-28"><a href="#cb48-28"></a>power_m_c5 &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb48-29"><a href="#cb48-29"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n_medium, <span class="dv">0</span>, sigma1)</span>
<span id="cb48-30"><a href="#cb48-30"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n_medium, <span class="dv">0</span>, sigma2)</span>
<span id="cb48-31"><a href="#cb48-31"></a><span class="kw">count5test</span>(x, y)</span>
<span id="cb48-32"><a href="#cb48-32"></a>}))</span>
<span id="cb48-33"><a href="#cb48-33"></a></span>
<span id="cb48-34"><a href="#cb48-34"></a>power_l_c5 &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb48-35"><a href="#cb48-35"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n_large, <span class="dv">0</span>, sigma1)</span>
<span id="cb48-36"><a href="#cb48-36"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n_large, <span class="dv">0</span>, sigma2)</span>
<span id="cb48-37"><a href="#cb48-37"></a><span class="kw">count5test</span>(x, y)</span>
<span id="cb48-38"><a href="#cb48-38"></a>}))</span>
<span id="cb48-39"><a href="#cb48-39"></a></span>
<span id="cb48-40"><a href="#cb48-40"></a>power_s_f &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb48-41"><a href="#cb48-41"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n_small, <span class="dv">0</span>, sigma1)</span>
<span id="cb48-42"><a href="#cb48-42"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n_small, <span class="dv">0</span>, sigma2)</span>
<span id="cb48-43"><a href="#cb48-43"></a><span class="kw">as.integer</span>(<span class="kw">var.test</span>(x,y)<span class="op">$</span>p.value <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.055</span>)</span>
<span id="cb48-44"><a href="#cb48-44"></a>}))</span>
<span id="cb48-45"><a href="#cb48-45"></a></span>
<span id="cb48-46"><a href="#cb48-46"></a>power_m_f &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb48-47"><a href="#cb48-47"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n_medium, <span class="dv">0</span>, sigma1)</span>
<span id="cb48-48"><a href="#cb48-48"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n_medium, <span class="dv">0</span>, sigma2)</span>
<span id="cb48-49"><a href="#cb48-49"></a><span class="kw">as.integer</span>(<span class="kw">var.test</span>(x,y)<span class="op">$</span>p.value <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.055</span>)</span>
<span id="cb48-50"><a href="#cb48-50"></a>}))</span>
<span id="cb48-51"><a href="#cb48-51"></a></span>
<span id="cb48-52"><a href="#cb48-52"></a>power_l_f &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb48-53"><a href="#cb48-53"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n_large, <span class="dv">0</span>, sigma1)</span>
<span id="cb48-54"><a href="#cb48-54"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n_large, <span class="dv">0</span>, sigma2)</span>
<span id="cb48-55"><a href="#cb48-55"></a><span class="kw">as.integer</span>(<span class="kw">var.test</span>(x,y)<span class="op">$</span>p.value <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.055</span>)</span>
<span id="cb48-56"><a href="#cb48-56"></a>}))</span>
<span id="cb48-57"><a href="#cb48-57"></a></span>
<span id="cb48-58"><a href="#cb48-58"></a><span class="kw">c</span>(power_s_c5, power_s_f)</span></code></pre></div>
<pre><code>## [1] 0.3115 0.4195</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="co"># For small sample sizes, Count Five Test power=0.3115, F-Test power=0.4220</span></span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="kw">c</span>(power_m_c5, power_m_f)</span></code></pre></div>
<pre><code>## [1] 0.806 0.950</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="co"># For medium sample sizes, Count Five Test power=0.8060, F-Test power=0.9500</span></span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="kw">c</span>(power_l_c5, power_l_f)</span></code></pre></div>
<pre><code>## [1] 0.955 1.000</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="co"># For large sample sizes, Count Five Test power=0.9550, F-Test power=1</span></span></code></pre></div>
</div>
</div>
<div id="exercise-6.c" class="section level2">
<h2>Exercise 6.C</h2>
<div id="problem-13" class="section level3">
<h3>Problem</h3>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If X and Y are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[\beta_{1,d}=E[(X-\mu)^T \Sigma^{-1}(Y-\mu)]^3\]</span> Under normality, <span class="math inline">\(\beta_{1,d}=0\)</span>. The multivariate skewness statistic is <span class="math display">\[b_{1,d}=\frac{1}{n^2} \sum_{i,j=1}^n [(X_i-\bar{X})^T \hat{\Sigma}^{-1}(X_j-\bar{X})]^3\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}\)</span> is chisquared with <span class="math inline">\(d(d+1)(d + 2)/6\)</span> degrees of freedom.</p>
</div>
<div id="solution-13" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="kw">set.seed</span>(<span class="dv">3333</span>)</span>
<span id="cb55-2"><a href="#cb55-2"></a><span class="kw">library</span>(MASS)</span>
<span id="cb55-3"><a href="#cb55-3"></a>mul_sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb55-4"><a href="#cb55-4"></a>  <span class="co"># computes the Mardia multivariate sample skewness coeff.</span></span>
<span id="cb55-5"><a href="#cb55-5"></a>  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x)</span>
<span id="cb55-6"><a href="#cb55-6"></a>  sigma &lt;-<span class="st"> </span><span class="kw">var</span>(x)</span>
<span id="cb55-7"><a href="#cb55-7"></a>  sigmainv &lt;-<span class="st"> </span><span class="kw">solve</span>(sigma)</span>
<span id="cb55-8"><a href="#cb55-8"></a>  mu &lt;-<span class="st"> </span><span class="kw">apply</span>(x,<span class="dv">2</span>,mean)</span>
<span id="cb55-9"><a href="#cb55-9"></a>  x_cen &lt;-<span class="st"> </span>x<span class="op">-</span>mu</span>
<span id="cb55-10"><a href="#cb55-10"></a>  sk &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb55-11"><a href="#cb55-11"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</span>
<span id="cb55-12"><a href="#cb55-12"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</span>
<span id="cb55-13"><a href="#cb55-13"></a>      sk &lt;-<span class="st"> </span>sk <span class="op">+</span><span class="st"> </span>(<span class="kw">t</span>(<span class="kw">as.matrix</span>(x_cen[i,])) <span class="op">%*%</span><span class="st"> </span>sigmainv <span class="op">%*%</span><span class="st"> </span><span class="kw">as.matrix</span>((x_cen[j,])))<span class="op">^</span><span class="dv">3</span></span>
<span id="cb55-14"><a href="#cb55-14"></a>  sk<span class="op">/</span>n<span class="op">^</span><span class="dv">2</span></span>
<span id="cb55-15"><a href="#cb55-15"></a>}</span>
<span id="cb55-16"><a href="#cb55-16"></a></span>
<span id="cb55-17"><a href="#cb55-17"></a>d &lt;-<span class="st"> </span><span class="dv">2</span>    <span class="co"># We suppose the dimension is 2</span></span>
<span id="cb55-18"><a href="#cb55-18"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>)    <span class="co"># sample sizes</span></span>
<span id="cb55-19"><a href="#cb55-19"></a>cv &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="fl">0.975</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb55-20"><a href="#cb55-20"></a></span>
<span id="cb55-21"><a href="#cb55-21"></a><span class="co"># n is a vector of sample sizes</span></span>
<span id="cb55-22"><a href="#cb55-22"></a><span class="co"># we are doing length(n) different simulations</span></span>
<span id="cb55-23"><a href="#cb55-23"></a>p.reject &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n))    <span class="co"># to store sim. results</span></span>
<span id="cb55-24"><a href="#cb55-24"></a>m &lt;-<span class="st"> </span><span class="dv">100</span>    <span class="co"># num. repl. each sim.  It should be 1000, but to shorten the vignettes creation time, I manually switch it to 100.</span></span>
<span id="cb55-25"><a href="#cb55-25"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb55-26"><a href="#cb55-26"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)    <span class="co"># test decisions</span></span>
<span id="cb55-27"><a href="#cb55-27"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb55-28"><a href="#cb55-28"></a>    x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n[i],<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>))    <span class="co"># test decision is 1 (reject) or 0</span></span>
<span id="cb55-29"><a href="#cb55-29"></a>    sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(n[i]<span class="op">*</span><span class="kw">abs</span>(<span class="kw">mul_sk</span>(x))<span class="op">/</span><span class="dv">6</span> <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb55-30"><a href="#cb55-30"></a>  }</span>
<span id="cb55-31"><a href="#cb55-31"></a>  p.reject[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)    <span class="co"># proportion rejected</span></span>
<span id="cb55-32"><a href="#cb55-32"></a>}</span>
<span id="cb55-33"><a href="#cb55-33"></a>p.reject</span></code></pre></div>
<pre><code>## [1] 0.20 0.16 0.11 0.09</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="co"># when n=5,10,20,30, p.reject=0.222,0.146,0.114,0.107</span></span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="co"># This is a repetition of Example 6.8 for multivariate case.</span></span>
<span id="cb57-3"><a href="#cb57-3"></a></span>
<span id="cb57-4"><a href="#cb57-4"></a>alpha &lt;-<span class="st"> </span><span class="fl">.1</span></span>
<span id="cb57-5"><a href="#cb57-5"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb57-6"><a href="#cb57-6"></a>m &lt;-<span class="st"> </span><span class="dv">30</span>    <span class="co"># It should be 100, but to shorten the vignettes creation time, I manually switch it to 30.</span></span>
<span id="cb57-7"><a href="#cb57-7"></a>epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.05</span>), <span class="kw">seq</span>(.<span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">.2</span>))</span>
<span id="cb57-8"><a href="#cb57-8"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</span>
<span id="cb57-9"><a href="#cb57-9"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb57-10"><a href="#cb57-10"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb57-11"><a href="#cb57-11"></a>cv &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="fl">0.975</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb57-12"><a href="#cb57-12"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {    <span class="co"># for each epsilon</span></span>
<span id="cb57-13"><a href="#cb57-13"></a>  e &lt;-<span class="st"> </span>epsilon[j]</span>
<span id="cb57-14"><a href="#cb57-14"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb57-15"><a href="#cb57-15"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {    <span class="co"># for each replicate</span></span>
<span id="cb57-16"><a href="#cb57-16"></a>    x &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>e)<span class="op">*</span><span class="kw">mvrnorm</span>(n, <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span>e<span class="op">*</span><span class="kw">mvrnorm</span>(n, <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>),<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb57-17"><a href="#cb57-17"></a>    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(n<span class="op">*</span><span class="kw">abs</span>(<span class="kw">mul_sk</span>(x))<span class="op">/</span><span class="dv">6</span> <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb57-18"><a href="#cb57-18"></a>  }</span>
<span id="cb57-19"><a href="#cb57-19"></a>  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb57-20"><a href="#cb57-20"></a>}</span>
<span id="cb57-21"><a href="#cb57-21"></a><span class="co"># plot power vs epsilon</span></span>
<span id="cb57-22"><a href="#cb57-22"></a><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb57-23"><a href="#cb57-23"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb57-24"><a href="#cb57-24"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m)    <span class="co"># add standard errors</span></span>
<span id="cb57-25"><a href="#cb57-25"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb57-26"><a href="#cb57-26"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAJACAMAAABSRCkEAAAAY1BMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6OmY6OpA6kNtmAABmADpmOgBmtttmtv+QOgCQZgCQ2/+2ZgC22/+2/7a2///bkDrbtmbb////tmb/25D/27b//7b//9v///87/C/AAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAU3UlEQVR4nO3dC3fa2JYE4EomTs+MfW/HE89EE3yx/v+vvEgYBwES51FSacv1rdUJNqU6G6OIZ2O0ZhWgHsBig3oAiw3qASw2qAew2KAewGKDegCLDeoBLDaoB7DYoB7AYoN6AIsN6gEsNqgHsNigHsBig3oAiw3qASw2qAew2KAewGKDegCLDeoBLDaoB7DYoB7AYoN6AIsN6gEsNqgHsNigHsBig3oAiw3qASw2qAew2KAewGKDegCLDeoBLDaoB7DYoB7AYoN6AIsN6gEsNqgHsNigHsBig3oAiw3qASw2qAew2KAewGKDegCLDeoBLDaoB7DYoB7AYoN6AIsN6gEsNqgHsNigHsBig3oAiw3qASw2qAew2KAewGKDegCLDeoBLDaoB7DYoB7AYoN6AIsN6gEsNqgHsNigHsBig3oAiw3qASw2qAew2KAewGKDegCLDeoBLDaoB7DYoB7AYoN6AIsN6gEsNqgHsNigHsBig3oAiw3qASw2qAew2KAewGIDuc42QrUDcetMBfSgpM5UQA9K6kwF9KCkzlRAD/beno/3sL7+otTZaoEe7DR4PJ7YnU5U1dl6gR5su+PPx27TfPtdXWcrBnrwYP/043RyN3IjllNnKwZ6sPUR6DMBPdhp8H4I8n2grQM92Ns/HR+FjRx/vANtBuhBSZ2pgB6U1JkK6MGhxo/Ctg304HRL9rsAbN1AD0rqTAX0oKTOVEAPSupMBfSgpM5UQA+2f55GnHhDR06drRjowc7b8+gbgUrqbL1AD/benh+YdbZaoAePdvgxeX5mna0V6EFJnamAHpTUmQroQUmdqYAelNSZCuhBSZ2pgB6U1JkK6EFJnamAHpTUmQroQUmdqYAelNSZCuhBSZ2pgB6U1JkK6EFJnamAHpTUmQroQUmdqYAelNSZCuhBSZ2pgB6U1JkK6EFJnamAHpTUmQroQUmdqYAelNSZCuhBSZ2pgB6U1JkK6EFJnamAHpTUmQroQUmdqYAelNSZCuhBSZ2pgB6U1JkK6EFJnamAHpTUmQroQUmdqYAelNSZCuhBSZ2pgB6U1JkK6EFJnamAHpTUmQroQUmdqYAelNSZCuhBSZ2pgB6U1JkK6EFJnamAHpTUmQroQUmdqYAelNSZCuhBSZ2pgB6U1JkK6EFJnamAHpTUmQroQUmdqYAelNSZCuhBSZ2pgB6U1JkK6EFJnamAHuy9AA9vz8Dob4/Pq7PVAj3Yab79PuxDD227f3ok1Nl6gR48eHs+7Da7Lz/b465UW2crBnqw7Y47h1uu3ddf7enPujpbMdCDrY9Anwnowc7HfaB+V6qus/UCPdjzo7DPAvSgpM5UQA9K6kwF9OBQ40dh2wZ6cLrlA6XO5EAPSupMBfSgpM5UQA/2+ofwByP3gLwDbQbowU6D9+cPd/ATidsGerAdPP/slzI2DvRg+/5i6pFfTN040IOtj0CfCejBTnN6Dcz3gbYO9GBv/3R8FDZy/PEOtBmgByV1pgJ6UFJnKqAHJXWmAnpQUmcqoAcldaYCelBSZyqgByV1pgJ6UFJnKqAHJXWmAnpQUmcqoAcldaYCelBSZyqgByV1pgJ6UFJnKqAHJXWmAnpQUmcqoAcldaYCelBSZyqgByV1pgJ6UFJnKqAHJXWmAnpQUmcqoAcldaYCelBSZyqgByV1pgJ6UFJnKqAHJXWmAnpQUmcqoAcldaYCelBSZyqgByV1pgJ6UFJnKqAHJXWmAnpQUmcqoAcldaYCelBSZyqgByV1pgJ6UFJnKqAHJXWmAnpQUmcqoAcldaYCelBSZyqgByV1pgJ6UFJnKqAHJXWmAnpQUmcqoAcldaYCelBSZyqgByV1pgJ6UFJnKqAHJXWmAnpQUmcqoAcldaYCelBSZyqgB3svX3+1r9+BLz8pdbZaoAc7/f7z18/u98f/INTZeoEebLvd5vGwEz10J5tvv6vrbMVAD7bH487b82N3cnc4FtXW2YqBHux0R5/GR6DPAPRgZ//09Vd/CNqN3YvOqrP1Aj14tEPvgVRnawV6UFJnKqAHJXWmAnpwqPGjsG0DPTjd8oFSZ3KgByV1pgJ6UFJnKqAHe2/PxxuqkXtA3oE2A/Rgp8Hj8cTudKKqztYL9GDbnl4H6/iljI0DPdgO3sThF1M3DvRg6yPQZwJ6sNPg/RDk+0BbB3qwt386PgobOf54B9oM0IOSOlMBPSipMxXQg5I6UwE9KKkzFdCDkjpTAT0oqTMV0IOSOlMBPSipMxXQg5I6UwE9KKkzFdCDkjpTAT0oqTMV0IOSOlMBPSipMxVkB8/eLbbEurZuyA6OfujYPOvauiE/OPY253nWtXVDdvD0ZsPx/+eLuq6tG+hBSZ2pgB6U1JkKsoOHm7DRzx2bYV1bN+QH3+8EjX6GOHddWzeUBrvP0VxiXVs3FAW7g5CPQNYW7UDd78CofiooeV1bN2QHK2+7cte1dUNB8HAIqn4clryurRvKgg1Q94pY8rq2bigN+lGYdZAffPFrYfYB2cHDQ/i6R/B569q6gR6U1JkKCoL9axmjHx1FXtfWDfnB4+8Aa/xMtLVl74k+PoB/qToGJa9r64bs4P4fx0NP3Ttbk9e1dUN28HQEGvsAX/K6tm7ID+76J6Gbuqeik9e1dUN28ONN9VXPJSava+sGelBSZyqgByV1pgJ6UFJnKqAHJXWmAnpQUmcqoAcldaYCelBSZyqgByV1pgJ6UFJnKqAHJXWmAnpQUmcqoAcldaYCelBSZyqgByV1pgJ6UFJnKqAHz7x+H33TWUmdrRDowTbpPWc5dbZioAc7O/SfZu8j0PaBHuztn7q33HsH2j7Qg+9evvz0DvQJgB48afDoHWj7QA9+eP3+H96BNg/04B9vz+P/71hBna0R6EFJnamAHhxq/DzQtoEenG75QKkzOdCDkjpTAT0oqTMV0IO9wwOw6U9fyKuz1QI92Gnw/puddxj5Fc9ZdbZeoAfbwW8GH/sYqpw6WzHQg+3gN4OPfRBeTp2tGOjB1kegzwT0YOfj8+98H2jrQA/2Tu9JHP0gzrw6Wy3Qg5I6UwE9KKkzFdCDkjpTAT0oqTMV0IOSOlMBPSipMxXQg5I6UwE9KKkzFdCDkjpTAT0oqTMV0IOSOlMBPSipMxXQg5I6UwE9KKkzFdCDkjpTAT0oqTMV0IOSOlMBPSipMxXQg5I6UwE9KKkzFdCDkjpTAT0oqTMV0IOSOlMBPSipMxXQg5I6UwE9KKkzFdCDkjpTAT0oqTMV0IOSOlMBPSipMxXQg5I6UwE9KKkzFdCDkjpTAT0oqTMV0IOSOlMBPSipMxXQg5I6UwE9KKkzFdCDkjpbBHD9reRteWPMUGcqoAcldTa7G0ef/tvJ23PGmKnOVEAPSupsViNHn/6s5I76MWasMxXQg5I6m83E0ac/O7mnboyZ60wF9KCkzmZx5+jTR5K7ysdYoM5UQA9K6owPxFROUFJndKDGvAN9LuAn0yvL6sj9VgMzRDM6y+rIC1gpzJPOq126zmgwUzyvtwGOvzq++fqLUGcLwXxbZFU3X362+6eHNm8HylrCZoAZN8npfnt+7P/89ts7UByYd6uc+v1Tf/PVvnz77ZuwKDDzZjn9xyPQwcuDd6AQMP+WWUucdpv9E/J2oKxVjAULbJq3RnN8DHY4FnkH2jbQg5I6K5bwlo3z8GU6eeucZZavs0WgvbrmcJ0a37ZA9p3ownWsRNbR53Td4Mb3kjeuhQ8zL2QzwNmfw+8lb0xDrrNsmUeffpOzP4ffS96YpqKuYlOG7gc/x38RoF3qPtDb8/GGauQe0HTdnaXyJqGZ+4peckcqXmepR2EN3p+K3p1OZNVNnJk1Bs2SR4g1Ho0Yd1mTg+3ZSxmHXenb7+q6+s2KQXOF9kejGbuJWyS35Sx7ejH1YDfHa2FVGycvAvHdLazjaHRnhulzS4It4wh082xMnsu0hivuhLoj5xZNPd+S2Zi19OmlsML7QLfPz5qgzGofEYEzV2ZFypLJlXlr75+Oj8JGjj/Xdfd39bnJB0hQNWPutmmLJbfmLp9Xh3sr3MizIMbOc1J6lMzbJPkfdHJt3vqZdRj93sjql1+XTgH585LFsnainGxed3Iyc4S8Oox+bz6RjjpjUv8BpGSGrelherCkDlNLkK/p1d5RLgXWMzXv8bx8cjpzjMw6ZK+Qlz5tVLRVDGOXbeTbYyVZ8Zz63OLMupuTT605dd7N9JZ3npOroytu5yY2z16SHiTWgXGtR76jXOr0Y0PJRplL0YOSurFVlllmlfIue/HzcMmbFfbPV1ffYCcV/9CStyxfIqcuZ5WcrE1Y5vntmkUy6pjLMLs2q/Y1pOSt65ZJr7u7Dv9J9iyzvGgneyWwft3kguqVEuvurYM/mXvROZwtv/LSlHUJiyZXENZKq5teCOeZ6egcBsuvuvT+qpyjXnIJZbWkusmVcD+S0FJssDyq3ShdCO02M7mHtWBC3f3zphIJJeWSl5eXTq/IWyy5ibfk/bqpM3F+/mQL0fBoQV/1vPTPUrOhLpDcxVz0bt3UuYMf8HRNteFNzfXyxHVuLMtf53qp+j56kFFXvVhtwZxXYe4QzCnqnjO8tXFyYc3K+XW3zs6YICN6ueUa9pwLtJlmOXjSg5y6q/NHLvy9nlQz/Gtnq5yw7sKNbpxcWrM6oW40n1t0tf3qd5wLZQPXXMLJbZN7KwYg1GXF08Lh9pyhrPErLua9LZOby0eYpW5i+zvVAW6sMqRcmqqjT3UgO0ism/rB4OrEve03teNcunHhqi9r0vbJayQHeXWYyuHqxNT2291zhs4uJ9qqKy110+QlkoO0OkwHx87A8ETCQpuEsz+LN5cEE+tw9z9Mn4/K7T/Ff4v8DNIkB0vrrr6DO+vi6kTe9tuGsz9zNsvdIjmfW0yow50cLv7O3X7b0C5y6ZOXSA4S6+7c871x5vBbn+Se84jsS1/000repqQ8ty53jat8boGdFP9TS96udIGsusxFcHXCSmCJbWsWma0OF39bCSyycdUqs9Vh7AtS/+ZV30tM3r52odS6vHUw8kVey2eFJTsYiyXV5S2Ei79LOj4rLFpCWY1Rh5tfYTxCpX9Gl4O2XnIPa8GUuqkzL8/D9RmT3YWWuJKX2pGoayR3MRe9Wzd2Lm6cffW96epMqqND/9+yy5YBPThjHS7+vt1UVH3ZoNhxRudgVjLL+kJ6cK660S0w+WXmEqv8lw/ODj3LP4jkTvLid+suA+MbYOKrJJFuMop3pJJtqL3kAe7XYeT09Ln3e8+yWMHNVKHc2TOieZKLyRNk1d0K3y5Iqo2841xKuSyzXtbk7uQgu4638JZ2nEujl+3W96gL04PEOnDW3fKOc+nysmIkx1uQHmTWTaaSKj7LjnNpsX80yWskB5erO++4+fY7xiI2DfSgrO6qkryG3QJ6UFGHGTotCejBJesw+Bu3zrJ5gR5ctA7nf+H6DJsb6EFZHbnSkoAe7L09o/f1F6XuvsGjMHa5jQM92GnweDyxO52oqpt03cTrtrtAD7bd8edjt2m+/a6um8ZrsgKgBw/2Tz9OJ3cjN2I5dbZioAfbhY9AF71zFdttoAc7Dd4PQQvcB2KXWRbQg7390/FR2MjxZ55nok0A9KCkbsZSmwR6UFI3W6fdAXpwqFnoURi7zxKBHpxu+UCpO29mF1oS0IOSOlMBPSipMxXQg73FX0w1EdCDnSVfTDUp0IOt9KUMWxjowdYvpn4moAdbH4E+E9CDnYVfTDUd0IO9hV9MNRnQg5I6UwE9KKkzFdCDkjpTAT0oqTMV0IOSOlMBPZhYZxsh2oGW6Z+jdI7OOKXlneVbCvvnKJ2jM05peWf5lsL+OUrn6IxTWt5ZvqWwf47SOTrjlJZ3lm8p7J+jdI7OOKXlneVbCvvnKJ2jM05peWf5lsL+OUrn6IxTWt5ZvqWwf47SOTrjlJZ3lm8p7J+jdI7OOKXlneVbmrXegawS1ANYbFAPYLFBPYDFBvUAFhvUA1hsUA9gsUE9gMUG9QAWG9QDWGxQD2CxQT2AxYZ5anfAl583vyCV9h+2N/IRIaWdnZfRz40oLX39DjzUdw5Lm8Ol/zGVTvX6nx8f9FR2NYExxZXdYZLdaZrBF6TSt+fDiab+irmcbTf+wSOFpbtD4f6pfg8alDbdF4w9aP/08UlhhVcT6oe4dvwkqpeH6y9Ypa/fu5/e2Medl3W2/cfX1O9ANy599aCXpQ8t40faHXROk5VeTage4obB1Uu6rm/1VB/XLjubb/9TvwMNL/1fjBvvi1LWDrTD48dnFZZeTagd4pbjT213/iMc+1DFwtKjl9rSi87Dl4T7QIPS3df/e2LcWRtOSrsJG1z2tuRqAmGIK8cjw/vxYfAFq/T4neorZtjZHcUJO9CgtOluI45HDF4p73HJnz2m9GoCY4pLy+xAO8596D+d3SeH0negL5zj73DS7tD7+p3wIHSlO9AiN2H1x59bg7Jvwo53Ko53MGilrLuVbbvSm7Al7kQ3jGeBBp3N+webVF/X56XHa6T+rvSwlHRQb893oDXdiZ7/YfyfTxwmdnYIR6BB6fHD2euPvzeexKgvPS9Z1cP4+Z9I5NwBuDEb45no4XN+h8KzT2jnlM5wH2hVTyT2NwfdLMeHHw3pIcNZ6fvNTX3tYNCW9FLGoHTHec1lWPpCKj3uQDVXExhT2OcF9QAWG9QDWGxQD2CxQT2AxQb1ABYb1ANYbFAPYLFBPYDFBvUAFhvUA1hsUA9gsUE9gMUG9QAWG9QDWGxQD2CxQT2AxQb1ABYb1ANYbFAPYLFBPYDFBvUAFhvUA1hsUA9gsUE9gMUG9QAWG9QDWGxQD2CxQT2AxQb1ABYb1ANYbFAPEM3/fwf+m/DRYFsB9QDBvP71N+EjMzcE6gGC2f+D88nzmwH1ANH8659gfLjlZkA9QDD7p7/VI6wL1AMEQ/ls3S2BeoBgXr//3f6L8Ou/NgPqAaJ5/SfwX/+rnmI9oB7AYoN6AIsN6gEsNqgHsNigHsBig3oAiw3qASw2qAew2KAewGKDegCLDeoBLDaoB7DYoB7AYoN6AIsN6gEsNqgHsNigHsBig3oAiw3qASw2qAew2KAewGKDegCLDeoBLDaoB7DY/g37CCl0+BI+qwAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="co"># This is a repetition of Example 6.10 for multivariate case.</span></span></code></pre></div>
</div>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<div id="problem-14" class="section level3">
<h3>Problem</h3>
<p>If we obtain the powers for two methods under a particular simulation setting with 10000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<ol style="list-style-type: decimal">
<li><p>What is the corresponding hypothesis test problem?</p></li>
<li><p>What test should we use? Z-test, two-sample t -test, paired-t-test or McNemar test?</p></li>
<li><p>What information is needed to test your hypothesis?</p></li>
</ol>
</div>
<div id="solution-14" class="section level3">
<h3>Solution</h3>
<ol style="list-style-type: decimal">
<li><p>H0: The powers of the methods are equal. H1: The powers of the methods are different.</p></li>
<li><p>Power is actually a random variable which obeys binomial distribution divided by n: B(n,p)/n, where n is the number of experiments (10000 in this case), and p denotes the probability that the method would reject the H0 in a single experiment.</p></li>
</ol>
<p>n=10000 is large enough. Thus, the normal approximation is reasonable. The nonparametric methods are also available. There are no pairwise relation. Thus, Z-test, two-sample t-test and McNemar test are practicable.</p>
<ol start="3" style="list-style-type: decimal">
<li>No other extra information is needed. For example, using the two-sample t-test, we can get the p-value &lt; 0.05, which means the powers of the methods are different at 0.05 level.</li>
</ol>
</div>
</div>
</div>
<div id="homework-6-2020-11-03" class="section level1">
<h1>Homework 6 (2020-11-03)</h1>
<div id="exercise-7.1" class="section level2">
<h2>Exercise 7.1</h2>
<div id="problem-15" class="section level3">
<h3>Problem</h3>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="solution-15" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="kw">set.seed</span>(<span class="dv">3333</span>)</span>
<span id="cb59-2"><a href="#cb59-2"></a><span class="kw">library</span>(bootstrap)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;bootstrap&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>law &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(law)</span>
<span id="cb61-2"><a href="#cb61-2"></a>corr &lt;-<span class="st"> </span><span class="kw">cor</span>(law[,<span class="dv">1</span>],law[,<span class="dv">2</span>])</span>
<span id="cb61-3"><a href="#cb61-3"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(law)</span>
<span id="cb61-4"><a href="#cb61-4"></a>jackknife_store &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb61-5"><a href="#cb61-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb61-6"><a href="#cb61-6"></a>  jacksample &lt;-<span class="st"> </span>law[<span class="op">-</span>i,]</span>
<span id="cb61-7"><a href="#cb61-7"></a>  jackknife_store[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(jacksample[,<span class="dv">1</span>],jacksample[,<span class="dv">2</span>])</span>
<span id="cb61-8"><a href="#cb61-8"></a>}</span>
<span id="cb61-9"><a href="#cb61-9"></a>jackknife_bias &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(jackknife_store)<span class="op">-</span>corr)</span>
<span id="cb61-10"><a href="#cb61-10"></a>jackknife_se &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(jackknife_store)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb61-11"><a href="#cb61-11"></a><span class="kw">c</span>(jackknife_bias, jackknife_se)</span></code></pre></div>
<pre><code>## [1] -0.006473623  0.142518619</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co"># Bias=-0.006473623, SE=0.1425186</span></span></code></pre></div>
</div>
</div>
<div id="exercise-7.5" class="section level2">
<h2>Exercise 7.5</h2>
<div id="problem-16" class="section level3">
<h3>Problem</h3>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="solution-16" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="kw">set.seed</span>(<span class="dv">3333</span>)</span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="kw">library</span>(boot)</span></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;boot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lattice&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>aircondit &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(aircondit)</span>
<span id="cb67-2"><a href="#cb67-2"></a>boot.mean &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">mean</span>(x[i])</span>
<span id="cb67-3"><a href="#cb67-3"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(aircondit, <span class="dt">statistic=</span>boot.mean, <span class="dt">R=</span><span class="dv">2000</span>)</span>
<span id="cb67-4"><a href="#cb67-4"></a><span class="kw">print</span>(<span class="kw">boot.ci</span>(boot.obj, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 34.7, 180.4 )   ( 23.0, 167.5 )  
## 
## Level     Percentile            BCa          
## 95%   ( 48.7, 193.2 )   ( 58.5, 229.4 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
</div>
</div>
<div id="exercise-7.8" class="section level2">
<h2>Exercise 7.8</h2>
<div id="problem-17" class="section level3">
<h3>Problem</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span></p>
</div>
<div id="solution-17" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="kw">set.seed</span>(<span class="dv">3333</span>)</span>
<span id="cb69-2"><a href="#cb69-2"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb69-3"><a href="#cb69-3"></a>scor &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(scor)</span>
<span id="cb69-4"><a href="#cb69-4"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</span>
<span id="cb69-5"><a href="#cb69-5"></a>lambda &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(scor))<span class="op">$</span>values</span>
<span id="cb69-6"><a href="#cb69-6"></a>theta &lt;-<span class="st"> </span>lambda[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>(lambda[<span class="dv">1</span>]<span class="op">+</span>lambda[<span class="dv">2</span>]<span class="op">+</span>lambda[<span class="dv">3</span>]<span class="op">+</span>lambda[<span class="dv">4</span>]<span class="op">+</span>lambda[<span class="dv">5</span>])</span>
<span id="cb69-7"><a href="#cb69-7"></a>jackknife_theta &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb69-8"><a href="#cb69-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb69-9"><a href="#cb69-9"></a>  jacksample &lt;-<span class="st"> </span>scor[<span class="op">-</span>i,]</span>
<span id="cb69-10"><a href="#cb69-10"></a>  lambda_j &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(jacksample))<span class="op">$</span>values</span>
<span id="cb69-11"><a href="#cb69-11"></a>  jackknife_theta[i] &lt;-<span class="st"> </span>lambda_j[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>(lambda_j[<span class="dv">1</span>]<span class="op">+</span>lambda_j[<span class="dv">2</span>]<span class="op">+</span>lambda_j[<span class="dv">3</span>]<span class="op">+</span>lambda_j[<span class="dv">4</span>]<span class="op">+</span>lambda_j[<span class="dv">5</span>])</span>
<span id="cb69-12"><a href="#cb69-12"></a>}</span>
<span id="cb69-13"><a href="#cb69-13"></a>jackknife_bias &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(jackknife_theta)<span class="op">-</span>theta)</span>
<span id="cb69-14"><a href="#cb69-14"></a>jackknife_se &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(jackknife_theta)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb69-15"><a href="#cb69-15"></a><span class="kw">c</span>(jackknife_bias,jackknife_se)</span></code></pre></div>
<pre><code>## [1] 0.001069139 0.049552307</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="co"># Bias=0.001069139, SE=0.049552307</span></span></code></pre></div>
</div>
</div>
<div id="exercise-7.8-1" class="section level2">
<h2>Exercise 7.8</h2>
<div id="problem-18" class="section level3">
<h3>Problem</h3>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="solution-18" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="kw">library</span>(DAAG)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;DAAG&#39;是用R版本4.0.3 来建造的</code></pre>
<pre><code>## 
## 载入程辑包：&#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="kw">attach</span>(ironslag)</span>
<span id="cb76-2"><a href="#cb76-2"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic)</span>
<span id="cb76-3"><a href="#cb76-3"></a>e1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb76-4"><a href="#cb76-4"></a>e2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb76-5"><a href="#cb76-5"></a>e3 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb76-6"><a href="#cb76-6"></a>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb76-7"><a href="#cb76-7"></a>count &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb76-8"><a href="#cb76-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>))</span>
<span id="cb76-9"><a href="#cb76-9"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n) {</span>
<span id="cb76-10"><a href="#cb76-10"></a>    count &lt;-<span class="st"> </span>count<span class="op">+</span><span class="dv">1</span></span>
<span id="cb76-11"><a href="#cb76-11"></a>    y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span><span class="kw">c</span>(i,j)]</span>
<span id="cb76-12"><a href="#cb76-12"></a>    x &lt;-<span class="st"> </span>chemical[<span class="op">-</span><span class="kw">c</span>(i,j)]</span>
<span id="cb76-13"><a href="#cb76-13"></a>    </span>
<span id="cb76-14"><a href="#cb76-14"></a>    P1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x)</span>
<span id="cb76-15"><a href="#cb76-15"></a>    y1_<span class="dv">1</span> &lt;-<span class="st"> </span>chemical[i]<span class="op">*</span>P1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>P1<span class="op">$</span>coef[<span class="dv">1</span>]</span>
<span id="cb76-16"><a href="#cb76-16"></a>    y1_<span class="dv">2</span> &lt;-<span class="st"> </span>chemical[j]<span class="op">*</span>P1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>P1<span class="op">$</span>coef[<span class="dv">1</span>]</span>
<span id="cb76-17"><a href="#cb76-17"></a>    e1[count] &lt;-<span class="st"> </span>(magnetic[i]<span class="op">-</span>y1_<span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[j]<span class="op">-</span>y1_<span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb76-18"><a href="#cb76-18"></a>    </span>
<span id="cb76-19"><a href="#cb76-19"></a>    P2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb76-20"><a href="#cb76-20"></a>    y2_<span class="dv">1</span> &lt;-<span class="st"> </span>P2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>P2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i] <span class="op">+</span><span class="st"> </span>P2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[i]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb76-21"><a href="#cb76-21"></a>    y2_<span class="dv">2</span> &lt;-<span class="st"> </span>P2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>P2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j] <span class="op">+</span><span class="st"> </span>P2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[j]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb76-22"><a href="#cb76-22"></a>    e2[count] &lt;-<span class="st"> </span>(magnetic[i]<span class="op">-</span>y2_<span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[j]<span class="op">-</span>y2_<span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb76-23"><a href="#cb76-23"></a>    </span>
<span id="cb76-24"><a href="#cb76-24"></a>    P3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y)<span class="op">~</span>x)</span>
<span id="cb76-25"><a href="#cb76-25"></a>    y3_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(P3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>P3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i])</span>
<span id="cb76-26"><a href="#cb76-26"></a>    y3_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(P3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>P3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j])</span>
<span id="cb76-27"><a href="#cb76-27"></a>    e3[count] &lt;-<span class="st"> </span>(magnetic[i]<span class="op">-</span>y3_<span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[j]<span class="op">-</span>y3_<span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb76-28"><a href="#cb76-28"></a>    </span>
<span id="cb76-29"><a href="#cb76-29"></a>    P4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y)<span class="op">~</span><span class="kw">log</span>(x))</span>
<span id="cb76-30"><a href="#cb76-30"></a>    y4_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(P4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>P4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[i]))</span>
<span id="cb76-31"><a href="#cb76-31"></a>    y4_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(P4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>P4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[j]))</span>
<span id="cb76-32"><a href="#cb76-32"></a>    e4[count] &lt;-<span class="st"> </span>(magnetic[i]<span class="op">-</span>y4_<span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[j]<span class="op">-</span>y4_<span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb76-33"><a href="#cb76-33"></a>  }</span>
<span id="cb76-34"><a href="#cb76-34"></a></span>
<span id="cb76-35"><a href="#cb76-35"></a><span class="kw">c</span>(<span class="kw">mean</span>(e1)<span class="op">/</span><span class="dv">2</span>,<span class="kw">mean</span>(e2)<span class="op">/</span><span class="dv">2</span>,<span class="kw">mean</span>(e3)<span class="op">/</span><span class="dv">2</span>,<span class="kw">mean</span>(e4)<span class="op">/</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="co"># 19.57227 17.87018 18.45491 20.46718</span></span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="co"># According to the prediction error criterion, Model 2, the quadratic model, would again be the best fit for the data.</span></span></code></pre></div>
</div>
</div>
</div>
<div id="homework-7-2020-11-10" class="section level1">
<h1>Homework 7 (2020-11-10)</h1>
<div id="exercise-8.3" class="section level2">
<h2>Exercise 8.3</h2>
<div id="problem-19" class="section level3">
<h3>Problem</h3>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="solution-19" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="co"># Case without Permutation:</span></span>
<span id="cb79-2"><a href="#cb79-2"></a></span>
<span id="cb79-3"><a href="#cb79-3"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb79-4"><a href="#cb79-4"></a></span>
<span id="cb79-5"><a href="#cb79-5"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb79-6"><a href="#cb79-6"></a>X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb79-7"><a href="#cb79-7"></a>Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb79-8"><a href="#cb79-8"></a>outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb79-9"><a href="#cb79-9"></a>outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb79-10"><a href="#cb79-10"></a><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb79-11"><a href="#cb79-11"></a>}</span>
<span id="cb79-12"><a href="#cb79-12"></a></span>
<span id="cb79-13"><a href="#cb79-13"></a>n1 &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb79-14"><a href="#cb79-14"></a>n2 &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb79-15"><a href="#cb79-15"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb79-16"><a href="#cb79-16"></a>sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb79-17"><a href="#cb79-17"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb79-18"><a href="#cb79-18"></a>alphahat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb79-19"><a href="#cb79-19"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb79-20"><a href="#cb79-20"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb79-21"><a href="#cb79-21"></a>x &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) <span class="co">#centered by sample mean</span></span>
<span id="cb79-22"><a href="#cb79-22"></a>y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb79-23"><a href="#cb79-23"></a><span class="kw">count5test</span>(x, y)</span>
<span id="cb79-24"><a href="#cb79-24"></a>}))</span>
<span id="cb79-25"><a href="#cb79-25"></a><span class="kw">print</span>(alphahat)</span></code></pre></div>
<pre><code>## [1] 0.104</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="co"># 0.104, suggests that the “Count Five” criterion does not necessarily control Type I error at alpha &lt;= 0.0625 when the sample sizes are unequal.</span></span>
<span id="cb81-2"><a href="#cb81-2"></a></span>
<span id="cb81-3"><a href="#cb81-3"></a><span class="co"># Now we use Permutation Method to deal with the same data:</span></span>
<span id="cb81-4"><a href="#cb81-4"></a></span>
<span id="cb81-5"><a href="#cb81-5"></a>per_countfivetest &lt;-<span class="st"> </span><span class="cf">function</span>(z,B) {</span>
<span id="cb81-6"><a href="#cb81-6"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(z)</span>
<span id="cb81-7"><a href="#cb81-7"></a>  rst &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,B)</span>
<span id="cb81-8"><a href="#cb81-8"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) {</span>
<span id="cb81-9"><a href="#cb81-9"></a>    z &lt;-<span class="st"> </span><span class="kw">sample</span>(z)</span>
<span id="cb81-10"><a href="#cb81-10"></a>    rst[i] &lt;-<span class="st"> </span><span class="kw">count5test</span>(z[<span class="dv">1</span><span class="op">:</span>(n<span class="op">/</span><span class="dv">2</span>)],z[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>(n<span class="op">/</span><span class="dv">2</span>))])</span>
<span id="cb81-11"><a href="#cb81-11"></a>  }</span>
<span id="cb81-12"><a href="#cb81-12"></a>  <span class="kw">mean</span>(rst)</span>
<span id="cb81-13"><a href="#cb81-13"></a>}</span>
<span id="cb81-14"><a href="#cb81-14"></a></span>
<span id="cb81-15"><a href="#cb81-15"></a>alphahat2 &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb81-16"><a href="#cb81-16"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb81-17"><a href="#cb81-17"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb81-18"><a href="#cb81-18"></a>x &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) <span class="co">#centered by sample mean</span></span>
<span id="cb81-19"><a href="#cb81-19"></a>y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb81-20"><a href="#cb81-20"></a><span class="kw">per_countfivetest</span>(<span class="kw">c</span>(x,y),<span class="dv">50</span>)</span>
<span id="cb81-21"><a href="#cb81-21"></a>}))</span>
<span id="cb81-22"><a href="#cb81-22"></a><span class="kw">print</span>(alphahat2)</span></code></pre></div>
<pre><code>## [1] 0.06154</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="co"># 0.06154, this is a good Type-I error, which is much closer to 0.0625, and suggests that this is an available permutation test for equal variance that applies when sample sizes are not necessarily equal.</span></span></code></pre></div>
</div>
</div>
<div id="discussion-1" class="section level2">
<h2>Discussion</h2>
<div id="problem-20" class="section level3">
<h3>Problem</h3>
<p>Design experiments for evaluating the performance of the NN, energy and ball methods in various situations:</p>
<p>(1).Unequal variances and equal expectations.</p>
<p>(2).Unequal variances and unequal expectations.</p>
<p>(3).Non-normal distributions: t distribution with 1 df.</p>
<p>(4).Non-normal distributions: mixture of two normal distributions.</p>
<p>(5).Unbalanced samples.</p>
</div>
<div id="solution-20" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="kw">set.seed</span>(<span class="dv">333</span>)</span>
<span id="cb84-2"><a href="#cb84-2"></a><span class="kw">library</span>(Ball)</span>
<span id="cb84-3"><a href="#cb84-3"></a><span class="kw">library</span>(energy)</span>
<span id="cb84-4"><a href="#cb84-4"></a><span class="kw">library</span>(boot)</span>
<span id="cb84-5"><a href="#cb84-5"></a><span class="kw">library</span>(RANN)</span>
<span id="cb84-6"><a href="#cb84-6"></a></span>
<span id="cb84-7"><a href="#cb84-7"></a>m &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb84-8"><a href="#cb84-8"></a>k &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb84-9"><a href="#cb84-9"></a>p &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb84-10"><a href="#cb84-10"></a>mu &lt;-<span class="st"> </span><span class="fl">0.2</span></span>
<span id="cb84-11"><a href="#cb84-11"></a>R &lt;-<span class="st"> </span><span class="dv">99</span></span>
<span id="cb84-12"><a href="#cb84-12"></a>n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2</span>
<span id="cb84-13"><a href="#cb84-13"></a>N &lt;-<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb84-14"><a href="#cb84-14"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb84-15"><a href="#cb84-15"></a>sample_size &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">80</span>,<span class="dv">100</span>)</span>
<span id="cb84-16"><a href="#cb84-16"></a></span>
<span id="cb84-17"><a href="#cb84-17"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb84-18"><a href="#cb84-18"></a>n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb84-19"><a href="#cb84-19"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb84-20"><a href="#cb84-20"></a>z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb84-21"><a href="#cb84-21"></a>NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb84-22"><a href="#cb84-22"></a>block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb84-23"><a href="#cb84-23"></a>block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb84-24"><a href="#cb84-24"></a>i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb84-25"><a href="#cb84-25"></a>(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb84-26"><a href="#cb84-26"></a>}</span>
<span id="cb84-27"><a href="#cb84-27"></a></span>
<span id="cb84-28"><a href="#cb84-28"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb84-29"><a href="#cb84-29"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb84-30"><a href="#cb84-30"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb84-31"><a href="#cb84-31"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb84-32"><a href="#cb84-32"></a>p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb84-33"><a href="#cb84-33"></a><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb84-34"><a href="#cb84-34"></a>}</span>
<span id="cb84-35"><a href="#cb84-35"></a></span>
<span id="cb84-36"><a href="#cb84-36"></a>compare_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="cf">function</span>(sample_size) {</span>
<span id="cb84-37"><a href="#cb84-37"></a>  n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span>sample_size</span>
<span id="cb84-38"><a href="#cb84-38"></a>  n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2</span>
<span id="cb84-39"><a href="#cb84-39"></a>  N &lt;-<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb84-40"><a href="#cb84-40"></a>  p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb84-41"><a href="#cb84-41"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb84-42"><a href="#cb84-42"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="fl">1.7</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb84-43"><a href="#cb84-43"></a>  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,<span class="dv">0</span>,<span class="fl">1.7</span>),<span class="kw">rnorm</span>(n2));</span>
<span id="cb84-44"><a href="#cb84-44"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb84-45"><a href="#cb84-45"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb84-46"><a href="#cb84-46"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb84-47"><a href="#cb84-47"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">99</span>,<span class="dt">seed=</span>i)<span class="op">$</span>p.value</span>
<span id="cb84-48"><a href="#cb84-48"></a>  }</span>
<span id="cb84-49"><a href="#cb84-49"></a>  <span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb84-50"><a href="#cb84-50"></a>}</span>
<span id="cb84-51"><a href="#cb84-51"></a></span>
<span id="cb84-52"><a href="#cb84-52"></a>case1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="dv">6</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb84-53"><a href="#cb84-53"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb84-54"><a href="#cb84-54"></a>  case1[i,] &lt;-<span class="st"> </span><span class="kw">compare_1</span>(sample_size[i])</span>
<span id="cb84-55"><a href="#cb84-55"></a></span>
<span id="cb84-56"><a href="#cb84-56"></a><span class="kw">plot</span>(<span class="dt">x=</span>sample_size, <span class="dt">y=</span>case1[,<span class="dv">1</span>], <span class="dt">type=</span><span class="st">&#39;b&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Power&#39;</span>, <span class="dt">main=</span><span class="st">&#39;Unequal variances and equal expectations&#39;</span>,<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">105</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb84-57"><a href="#cb84-57"></a><span class="kw">lines</span>(<span class="dt">x=</span>sample_size, <span class="dt">y=</span>case1[,<span class="dv">2</span>], <span class="dt">type=</span><span class="st">&quot;b&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb84-58"><a href="#cb84-58"></a><span class="kw">lines</span>(<span class="dt">x=</span>sample_size, <span class="dt">y=</span>case1[,<span class="dv">3</span>], <span class="dt">type=</span><span class="st">&quot;b&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="dv">3</span>)</span>
<span id="cb84-59"><a href="#cb84-59"></a><span class="kw">legend</span>(<span class="dt">x=</span><span class="dv">5</span>,<span class="dt">y=</span><span class="dv">1</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;Energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>),<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb84-60"><a href="#cb84-60"></a></span>
<span id="cb84-61"><a href="#cb84-61"></a><span class="co"># Unequal variances and equal expectations</span></span>
<span id="cb84-62"><a href="#cb84-62"></a></span>
<span id="cb84-63"><a href="#cb84-63"></a><span class="co"># To save the time of create vignette, we don&#39;t run the remaining three cases.</span></span>
<span id="cb84-64"><a href="#cb84-64"></a>compare_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="cf">function</span>(sample_size) {</span>
<span id="cb84-65"><a href="#cb84-65"></a>  n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span>sample_size</span>
<span id="cb84-66"><a href="#cb84-66"></a>  n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2</span>
<span id="cb84-67"><a href="#cb84-67"></a>  N &lt;-<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb84-68"><a href="#cb84-68"></a>  p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb84-69"><a href="#cb84-69"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb84-70"><a href="#cb84-70"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="fl">1.7</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb84-71"><a href="#cb84-71"></a>  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,<span class="dv">0</span>,<span class="fl">1.7</span>),<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span>mu));</span>
<span id="cb84-72"><a href="#cb84-72"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb84-73"><a href="#cb84-73"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb84-74"><a href="#cb84-74"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb84-75"><a href="#cb84-75"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">99</span>,<span class="dt">seed=</span>i)<span class="op">$</span>p.value</span>
<span id="cb84-76"><a href="#cb84-76"></a>  }</span>
<span id="cb84-77"><a href="#cb84-77"></a>  <span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb84-78"><a href="#cb84-78"></a>}</span>
<span id="cb84-79"><a href="#cb84-79"></a></span>
<span id="cb84-80"><a href="#cb84-80"></a>case2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="dv">6</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb84-81"><a href="#cb84-81"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb84-82"><a href="#cb84-82"></a>  case2[i,] &lt;-<span class="st"> </span><span class="kw">compare_2</span>(sample_size[i])</span>
<span id="cb84-83"><a href="#cb84-83"></a></span>
<span id="cb84-84"><a href="#cb84-84"></a><span class="kw">plot</span>(<span class="dt">x=</span>sample_size, <span class="dt">y=</span>case2[,<span class="dv">1</span>], <span class="dt">type=</span><span class="st">&#39;b&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Power&#39;</span>, <span class="dt">main=</span><span class="st">&#39;Unequal variances and unequal expectations&#39;</span>,<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">105</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb84-85"><a href="#cb84-85"></a><span class="kw">lines</span>(<span class="dt">x=</span>sample_size, <span class="dt">y=</span>case2[,<span class="dv">2</span>], <span class="dt">type=</span><span class="st">&quot;b&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb84-86"><a href="#cb84-86"></a><span class="kw">lines</span>(<span class="dt">x=</span>sample_size, <span class="dt">y=</span>case2[,<span class="dv">3</span>], <span class="dt">type=</span><span class="st">&quot;b&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="dv">3</span>)</span>
<span id="cb84-87"><a href="#cb84-87"></a><span class="kw">legend</span>(<span class="dt">x=</span><span class="dv">70</span>,<span class="dt">y=</span><span class="fl">0.4</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;Energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>),<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb84-88"><a href="#cb84-88"></a></span>
<span id="cb84-89"><a href="#cb84-89"></a></span>
<span id="cb84-90"><a href="#cb84-90"></a><span class="co"># Unequal variances and unequal expectations.</span></span>
<span id="cb84-91"><a href="#cb84-91"></a></span>
<span id="cb84-92"><a href="#cb84-92"></a>compare_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="cf">function</span>(sample_size) {</span>
<span id="cb84-93"><a href="#cb84-93"></a>  n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span>sample_size</span>
<span id="cb84-94"><a href="#cb84-94"></a>  n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2</span>
<span id="cb84-95"><a href="#cb84-95"></a>  N &lt;-<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb84-96"><a href="#cb84-96"></a>  p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb84-97"><a href="#cb84-97"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb84-98"><a href="#cb84-98"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dv">1</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb84-99"><a href="#cb84-99"></a>  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rt</span>(n2,<span class="dv">1</span>),<span class="kw">rt</span>(n2,<span class="dv">100</span>));</span>
<span id="cb84-100"><a href="#cb84-100"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb84-101"><a href="#cb84-101"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb84-102"><a href="#cb84-102"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb84-103"><a href="#cb84-103"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">99</span>,<span class="dt">seed=</span>i)<span class="op">$</span>p.value</span>
<span id="cb84-104"><a href="#cb84-104"></a>  }</span>
<span id="cb84-105"><a href="#cb84-105"></a>  <span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb84-106"><a href="#cb84-106"></a>}</span>
<span id="cb84-107"><a href="#cb84-107"></a></span>
<span id="cb84-108"><a href="#cb84-108"></a>case3 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="dv">6</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb84-109"><a href="#cb84-109"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb84-110"><a href="#cb84-110"></a>  case3[i,] &lt;-<span class="st"> </span><span class="kw">compare_3</span>(sample_size[i])</span>
<span id="cb84-111"><a href="#cb84-111"></a></span>
<span id="cb84-112"><a href="#cb84-112"></a><span class="kw">plot</span>(<span class="dt">x=</span>sample_size, <span class="dt">y=</span>case3[,<span class="dv">1</span>], <span class="dt">type=</span><span class="st">&#39;b&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Power&#39;</span>, <span class="dt">main=</span><span class="st">&#39; t-distribution&#39;</span>,<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">105</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb84-113"><a href="#cb84-113"></a><span class="kw">lines</span>(<span class="dt">x=</span>sample_size, <span class="dt">y=</span>case3[,<span class="dv">2</span>], <span class="dt">type=</span><span class="st">&quot;b&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb84-114"><a href="#cb84-114"></a><span class="kw">lines</span>(<span class="dt">x=</span>sample_size, <span class="dt">y=</span>case3[,<span class="dv">3</span>], <span class="dt">type=</span><span class="st">&quot;b&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="dv">3</span>)</span>
<span id="cb84-115"><a href="#cb84-115"></a><span class="kw">legend</span>(<span class="dt">x=</span><span class="dv">5</span>,<span class="dt">y=</span><span class="dv">1</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;Energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>),<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb84-116"><a href="#cb84-116"></a></span>
<span id="cb84-117"><a href="#cb84-117"></a><span class="co"># Non-normal distributions: t distribution with 1 df.</span></span>
<span id="cb84-118"><a href="#cb84-118"></a></span>
<span id="cb84-119"><a href="#cb84-119"></a>compare_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="cf">function</span>(sample_size) {</span>
<span id="cb84-120"><a href="#cb84-120"></a>  n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span>sample_size</span>
<span id="cb84-121"><a href="#cb84-121"></a>  n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2</span>
<span id="cb84-122"><a href="#cb84-122"></a>  N &lt;-<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb84-123"><a href="#cb84-123"></a>  p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb84-124"><a href="#cb84-124"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb84-125"><a href="#cb84-125"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,(<span class="kw">sample</span>(<span class="dv">10</span>)<span class="op">&lt;</span><span class="dv">3</span>)<span class="op">*</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb84-126"><a href="#cb84-126"></a>  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,(<span class="kw">sample</span>(<span class="dv">10</span>)<span class="op">&lt;</span><span class="dv">3</span>)<span class="op">*</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="kw">rnorm</span>(n2,(<span class="kw">sample</span>(<span class="dv">10</span>)<span class="op">&gt;=</span><span class="dv">3</span>)<span class="op">*</span><span class="dv">1</span>,<span class="dv">1</span>));</span>
<span id="cb84-127"><a href="#cb84-127"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb84-128"><a href="#cb84-128"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb84-129"><a href="#cb84-129"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb84-130"><a href="#cb84-130"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">99</span>,<span class="dt">seed=</span>i)<span class="op">$</span>p.value</span>
<span id="cb84-131"><a href="#cb84-131"></a>  }</span>
<span id="cb84-132"><a href="#cb84-132"></a>  <span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb84-133"><a href="#cb84-133"></a>}</span>
<span id="cb84-134"><a href="#cb84-134"></a></span>
<span id="cb84-135"><a href="#cb84-135"></a>case4 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="dv">6</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb84-136"><a href="#cb84-136"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb84-137"><a href="#cb84-137"></a>  case4[i,] &lt;-<span class="st"> </span><span class="kw">compare_4</span>(sample_size[i])</span>
<span id="cb84-138"><a href="#cb84-138"></a></span>
<span id="cb84-139"><a href="#cb84-139"></a><span class="kw">plot</span>(<span class="dt">x=</span>sample_size, <span class="dt">y=</span>case4[,<span class="dv">1</span>], <span class="dt">type=</span><span class="st">&#39;b&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Power&#39;</span>, <span class="dt">main=</span><span class="st">&#39;mixture normal distribution&#39;</span>,<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">105</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb84-140"><a href="#cb84-140"></a><span class="kw">lines</span>(<span class="dt">x=</span>sample_size, <span class="dt">y=</span>case4[,<span class="dv">2</span>], <span class="dt">type=</span><span class="st">&quot;b&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb84-141"><a href="#cb84-141"></a><span class="kw">lines</span>(<span class="dt">x=</span>sample_size, <span class="dt">y=</span>case4[,<span class="dv">3</span>], <span class="dt">type=</span><span class="st">&quot;b&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="dv">3</span>)</span>
<span id="cb84-142"><a href="#cb84-142"></a><span class="kw">legend</span>(<span class="dt">x=</span><span class="dv">5</span>,<span class="dt">y=</span><span class="dv">1</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;Energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>),<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb84-143"><a href="#cb84-143"></a></span>
<span id="cb84-144"><a href="#cb84-144"></a><span class="co"># Non-normal distributions: mixture of two normal distributions.</span></span>
<span id="cb84-145"><a href="#cb84-145"></a></span>
<span id="cb84-146"><a href="#cb84-146"></a>compare_<span class="dv">5</span> &lt;-<span class="st"> </span><span class="cf">function</span>(sample_size) {</span>
<span id="cb84-147"><a href="#cb84-147"></a>  n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span>sample_size</span>
<span id="cb84-148"><a href="#cb84-148"></a>  n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2</span>
<span id="cb84-149"><a href="#cb84-149"></a>  N &lt;-<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb84-150"><a href="#cb84-150"></a>  p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb84-151"><a href="#cb84-151"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb84-152"><a href="#cb84-152"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>(p<span class="op">+</span><span class="dv">3</span>),<span class="dv">0</span>,<span class="fl">1.7</span>),<span class="dt">ncol=</span>p<span class="op">+</span><span class="dv">3</span>);</span>
<span id="cb84-153"><a href="#cb84-153"></a>  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,<span class="dv">0</span>,<span class="fl">1.7</span>),<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2));</span>
<span id="cb84-154"><a href="#cb84-154"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb84-155"><a href="#cb84-155"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb84-156"><a href="#cb84-156"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb84-157"><a href="#cb84-157"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">99</span>,<span class="dt">seed=</span>i)<span class="op">$</span>p.value</span>
<span id="cb84-158"><a href="#cb84-158"></a>  }</span>
<span id="cb84-159"><a href="#cb84-159"></a>  <span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb84-160"><a href="#cb84-160"></a>}</span>
<span id="cb84-161"><a href="#cb84-161"></a></span>
<span id="cb84-162"><a href="#cb84-162"></a>case5 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="dv">6</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb84-163"><a href="#cb84-163"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb84-164"><a href="#cb84-164"></a>  case5[i,] &lt;-<span class="st"> </span><span class="kw">compare_5</span>(sample_size[i])</span>
<span id="cb84-165"><a href="#cb84-165"></a></span>
<span id="cb84-166"><a href="#cb84-166"></a><span class="kw">plot</span>(<span class="dt">x=</span>sample_size, <span class="dt">y=</span>case5[,<span class="dv">1</span>], <span class="dt">type=</span><span class="st">&#39;b&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;Sample size&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Power&#39;</span>, <span class="dt">main=</span><span class="st">&#39;Unbalanced samples with the Case 1&#39;</span>,<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">105</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb84-167"><a href="#cb84-167"></a><span class="kw">lines</span>(<span class="dt">x=</span>sample_size, <span class="dt">y=</span>case5[,<span class="dv">2</span>], <span class="dt">type=</span><span class="st">&quot;b&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb84-168"><a href="#cb84-168"></a><span class="kw">lines</span>(<span class="dt">x=</span>sample_size, <span class="dt">y=</span>case5[,<span class="dv">3</span>], <span class="dt">type=</span><span class="st">&quot;b&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="dv">3</span>)</span>
<span id="cb84-169"><a href="#cb84-169"></a><span class="kw">legend</span>(<span class="dt">x=</span><span class="dv">70</span>,<span class="dt">y=</span><span class="fl">0.4</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;Energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>),<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">cex=</span><span class="fl">0.8</span>)</span>
<span id="cb84-170"><a href="#cb84-170"></a></span>
<span id="cb84-171"><a href="#cb84-171"></a><span class="co"># Unbalanced samples with the Case 1. (1:4)</span></span>
<span id="cb84-172"><a href="#cb84-172"></a></span>
<span id="cb84-173"><a href="#cb84-173"></a><span class="co"># From the comparison, we can find that Ball test is usually the most powerful method of these three. When dealing with mixture normal distribution, Energy test behaves better.</span></span></code></pre></div>
</div>
</div>
</div>
<div id="homework-8-2020-11-17" class="section level1">
<h1>Homework 8 (2020-11-17)</h1>
<div id="exercise-9.4" class="section level2">
<h2>Exercise 9.4</h2>
<div id="problem-21" class="section level3">
<h3>Problem</h3>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution. For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="solution-21" class="section level3">
<h3>Solution</h3>
<p>The standard Laplace distribution has density <span class="math display">\[
f(x)=\frac{1}{2}e^{-|x|},~~~~x \in R
\]</span> Thus, <span class="math display">\[
r(x_t,y)=f(Y)/f(X_t)=e^{-|y|+|x_t|}
\]</span></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="kw">set.seed</span>(<span class="dv">3333</span>)</span>
<span id="cb85-2"><a href="#cb85-2"></a>rw.Metro.Laplace &lt;-<span class="st"> </span><span class="cf">function</span>(sigma,x0,N) {</span>
<span id="cb85-3"><a href="#cb85-3"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb85-4"><a href="#cb85-4"></a>  x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb85-5"><a href="#cb85-5"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb85-6"><a href="#cb85-6"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb85-7"><a href="#cb85-7"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb85-8"><a href="#cb85-8"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean=</span>x[i<span class="dv">-1</span>], <span class="dt">sd=</span>sigma)</span>
<span id="cb85-9"><a href="#cb85-9"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="kw">abs</span>(y)))</span>
<span id="cb85-10"><a href="#cb85-10"></a>      x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb85-11"><a href="#cb85-11"></a>        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb85-12"><a href="#cb85-12"></a>        k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb85-13"><a href="#cb85-13"></a>      }</span>
<span id="cb85-14"><a href="#cb85-14"></a>  }</span>
<span id="cb85-15"><a href="#cb85-15"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x,<span class="dt">k=</span>k))</span>
<span id="cb85-16"><a href="#cb85-16"></a>}</span>
<span id="cb85-17"><a href="#cb85-17"></a></span>
<span id="cb85-18"><a href="#cb85-18"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.2</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">10</span>)</span>
<span id="cb85-19"><a href="#cb85-19"></a>x0 &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb85-20"><a href="#cb85-20"></a>N &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb85-21"><a href="#cb85-21"></a></span>
<span id="cb85-22"><a href="#cb85-22"></a>rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metro.Laplace</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb85-23"><a href="#cb85-23"></a>rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metro.Laplace</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb85-24"><a href="#cb85-24"></a>rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metro.Laplace</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb85-25"><a href="#cb85-25"></a>rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metro.Laplace</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb85-26"><a href="#cb85-26"></a>rw5 &lt;-<span class="st"> </span><span class="kw">rw.Metro.Laplace</span>(sigma[<span class="dv">5</span>],x0,N)</span>
<span id="cb85-27"><a href="#cb85-27"></a>rw6 &lt;-<span class="st"> </span><span class="kw">rw.Metro.Laplace</span>(sigma[<span class="dv">6</span>],x0,N)</span>
<span id="cb85-28"><a href="#cb85-28"></a><span class="kw">print</span>(<span class="kw">cbind</span>(<span class="dt">sigma=</span>sigma, <span class="dt">acc_rate=</span><span class="dv">1</span><span class="op">-</span><span class="kw">c</span>(rw1<span class="op">$</span>k,rw2<span class="op">$</span>k,rw3<span class="op">$</span>k,rw4<span class="op">$</span>k,rw5<span class="op">$</span>k,rw6<span class="op">$</span>k)<span class="op">/</span>N))</span></code></pre></div>
<pre><code>##      sigma acc_rate
## [1,]  0.05   0.9825
## [2,]  0.20   0.9315
## [3,]  0.50   0.8500
## [4,]  1.00   0.6965
## [5,]  2.00   0.5555
## [6,] 10.00   0.1505</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb87-2"><a href="#cb87-2"></a><span class="kw">plot</span>(rw1<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;sigma=0.05&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;X&#39;</span>)</span>
<span id="cb87-3"><a href="#cb87-3"></a><span class="kw">plot</span>(rw2<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;sigma=0.2&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;X&#39;</span>)</span>
<span id="cb87-4"><a href="#cb87-4"></a><span class="kw">plot</span>(rw3<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;sigma=0.5&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;X&#39;</span>)</span>
<span id="cb87-5"><a href="#cb87-5"></a><span class="kw">plot</span>(rw4<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;sigma=1&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;X&#39;</span>)</span>
<span id="cb87-6"><a href="#cb87-6"></a><span class="kw">plot</span>(rw5<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;sigma=2&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;X&#39;</span>)</span>
<span id="cb87-7"><a href="#cb87-7"></a><span class="kw">plot</span>(rw6<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;sigma=10&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;X&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAJACAMAAABSRCkEAAAAh1BMVEUAAAAAADoAAGYAOjoAOpAAZmYAZrY6AAA6ADo6AGY6OmY6OpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmOpBmZgBmkNtmtv+QOgCQOjqQOmaQkDqQ27aQ2/+2ZgC2Zjq2/7a2///bkDrbtmbb25Db/7bb////tmb/25D/29v//7b//9v///9NEd7oAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2dC3vcttGF4TSV07q17N7kpJ/cWE0sVcL//33fcpckLgRADGaABbjnPG2sXRAzB+RLAuDyojQEMaSubQAaWwAIYgkAQSwBIIglAASxBIAglgAQxBIAglgCQBBLAAhiCQBBLAEgiCUABLEEgCCWABDEEgCCWAJAEEsACGIJAEEsASCIJQAEsQSAIJYAEMQSAIJYAkAQSwAIYgkAQSwBIIglAASxBIAglgAQxBIAglgCQBBLAAhiCQBBLAEgiCUABLEEgCCWABDEEgCCWAJAEEsACGIJAEEsASCIJQAEsQSAIJYAEMQSAIJYAkAQSwAIYqkEINVesm2Gfzn/RQAVN71UwhtANFr7jF35B0AtVJrx+bz7v3uUiVYuAFQxWsWMb18epn9ePnyXiMYQAKoYrWLG18/frH+40RgCQBWjVcy4HIH+BICYulGA9Mv7WxoDCU9WMzKyolW0G8koEMdMqptSBIC20aRPzuxnLNDpCHQXGQMBIIGMu0pMg0cAaBoDPf/w7aAAbWr2B1BqGjwCQGdyXj//CoC4qjANnscSbbZD6Q7w83TsfP17aBY2PEBbXCru0xWmwerit2uATmOgqQGnXmwbDQCRMxYoMQ0eAqBENABEzigRx54GT380GgndLEDJWYz3ZfpXf56qTIMBEC0juWhvFuMF6hCg9DQYANEykov2ZjFeoPPmKLK3rwrTYA2AiBnJRTuzmAEASk2DZ8dtNsStApScxQQAqtaqCtPgpdNtcgi6WYA2S1uzmBEASkYDQLSM5CKdnMX4NccESDx2MqNktCEASs1itgDtRWOoEkAaABEykot2ZjHesb9qqwDQJtoQACVnMcMDpAEQKSO5SKdnMeMDtPnU24nQVLQxAErWORxA3Z1JT0U7KkB12lUVoPV8IgBKZiQX7dU5DkAXhPr7LS8V7VgALefjBgaoxx+DU9EAUEHGKtEAUGZGctFeHWt9m9836myG6gDtPsVEMqNItCMDJN82ALSJBoAKMtaJ1i9A0y8BT0r96F7PdxiAnDMoy8nFAQHSPQP0fBe7IpRtiqAGAC3/jgqQrnplRzlATx8zr4aoqtoAKQNQndMpdQE6f1P1TGIpQPc//vav0z//CD1gCgAVZKwYrUeAph8j3z2+/BR8vMuhALKKqvRhzQCqtFWkwtpDhMMCVGMzNAKoGkE1/B8IoM1aHxGgSwkASmSkFu3WAUD8jEm93l+6rPD1WFxTBAGgzGidAaRfPz0Gvj0eQBJBszLWjtYbQPrZPwttoh0HoMBzOgqCZmUkKvVTQDhPbwAloh0BIGX/wwyalZGo1E8BkTx1LkgBQME6kXtUuwIo/lNAOE+dY9DNAvT2ZZoEfIzU6R+g1E8BkUwAKJqRWnTSfx71y1/0012kTuyR170AlPwpIJIJAEUzUosux/63nx+jXcDl3s6eAfLj7F4tMBBADQkqBWi6M/Xtl2/RQWjst9NuAcqIBoCiGalF+nIq9CHeBUQf8SXdtoYAjTMLGwGgzdJuFxDtEDoBKPlTgHCuhjEHBsiv0zlAyZ8CpHO1iwmAGBmJSvwUIJ+sVcjoLwDVVDwL2+sCugeoJBoAimUkFun9LiB2JToAqhlyIID2uoBjAjTIFZVDALRXBwBJZCyLdgiAIgEAECljWTQAVJixdjQAFMtILMqrA4D4GcuirTbrg1QTILGo7eLtRRsLoBav+wBApGjyh6BKAKnLJwDUON6RAGrzwiEARIrWD0CJN0YCINmMotF6ASj1xsgFIAWARDKKRusFoNQbI/XyWKNjAiTcpsYA9bIDpN4Yef7j8mP2AQGSbtONApR6Y+T5DwAkl1E0Wi8AbeIErwgFQI3DHcZ/7WeDbjOSijh1xtgAiUWaZyyJBoAEM8pG6wOgvStCVSuCABA1mvBGKQ22c0UoABLMKButE4B2rgg9MkBddAHl0XoBKB0NAAlmFI42CkB1HqsczUgq4tQZHiDZlNUA0p0D9PL+3f/d+5OA43QBzVJW9N/kTGIpQG+/fJvmAZQHNC2LyBJUGit5OcROyh78Z0TrGqDXz9+mX4LzHxFnFukCoPTlEDspO/CfFS32kKZ6GXOL1iNQwQYQ7plLT8QlL4fYSQmAYhlzi/TUBZSPgToAaO9yiN2cUm2oDlDlcfQOQPMY53S82Q2Ue9pB+PVt6VBx/zuXQ+zmbANQ/voPRrs+QKf1fNpTn/31XBJuXaQlQPn+KefdGh6BuOv/6gBp/VWpu/hC+eHsZVp2YeL+Ly1o1oXx/PcBkP80aF34iDjqYiKhwv5Loy1LNQWI4b/W89HjGb2i8yH0KXAILXlEHHUxgVAx/6wdQAmejCj0nxut+tno8kF0ySPiiIvxQ8X9c3aAdgAxB9HXB0gwHDe0dCjGDhB7CHaJKv8UA4AahsqPNhhANQkCQCXRBO94AEAldQ4AkFRmAFRSZ3yAxDIDoJI6AIiasTTa5cIy0Rw7GbOKuHUAEDVjcbSDArSzHCE1AEpHu1GA8nNfBSANgOIZc4q4ddJvBhwAoGVZfvbCCNmvLQdAMhkrRLs2QNmvLb8xgIgTzysCJDJBLgfIfW154nqmAwKkE+fhAFCOKK8tPyRA8XUPgPKU/9ryqmcSAVB5tOsClB8NAElkrBANAMUy7hax6+wARMh9VYCuNwujRLsJgJRbBIAEo1W9wbkbgMwbimiXSvQBULmLJv5rAKR2Q18LoNQcvzxjhWgAKB36OgBR7+e+JkBmLR4ZoHTMq51IjAKUPMtYnrFOtNk1Y5jaPUCxpjEBer0P3u0mB1B+JEkBoE2VWgB9/rf/ZI7dOt6izrLKNZS/Ra4LkLFb6uN2Afr2eq8eSHW8RUMAqS1AO5umI4CKrFwHoP2sDQDS033bZffGX4zZC6tl9rUZlgIgfrQ4QKEKyl0iFlOlMu4UbR/tlVMn7GD5+/IsGxUAKBm0B4DmJ9YUdWPdArSUVAIoEI/66/ShANKlj8EAQMV1kgDpygBlXxK6o+EB2qzvMEDbwP0BpBoDlH1J6G766T+lVwf1AZByDvlWQRSgpbnFYyDWA6YsZ2s95XaCHkDxH+8JGS1RLglNaR37lN4C2hggf+4UBGhe4cpaYtM0LkC8B0xtFl4AMl9avXQVgAiXhKak1LrCBwDIPl27fLMUtAaI9YCpzcIGoE2h0m7fxsloK/+S0JRsgIqmYVcDyMaDCpCSAIhfx8OlMUAy0RyASsy0BMjsox5AbkESIGWWuixHNlPSgNjCnqsoQInu4coA6eEActd1GCAVBUj1DVAoUu8ArdvkmACpngHyj4shgNQwAJWZuS5A6sKJBZAaF6BwJLXsE/0CxKneCqBlkLlu9hyArK55C5DuHSDLMQBiRnMBWrspHyClMgBS5qsOAFpshQpNUc8AhUf+VTPSo5mJ1QUV5QO0gmFGDIY08/f6uSOA1vFDINRiUCUGqAAoI9plRbtwGIDMQWg+/LjQBP5eYqX9VwdIK70H0NpjdwyQXHWKSK/stACy6VjZcA41NmZxgPRIAG1Dq3XP7wuggjEUPeMk2is7CwDSSYBUHwCtozM6QKobgJzqzQDavLLT6pdCvvy+ig6Q2gK0478JQHGMNwApq+jmAaK9stPrecwARrkTMRcg+5C1/NeEGhigdX8odZnww61PDlCakfTKTiJAWscBcnq0tP+rA+Qek4cEKHr2QSxjVjSz0bU5lOg0QDoCkDcBA0BeUmb9TgGy1uWy6maelpnMCslaqO1BUwigPf8tAEoM5U1r/NgjAaT2EOoFIDNEnhfSZveeeyxlH7Yy/LcBSKcBCsVWNlsDAJQM2si/C9C87LzzWsOeFaCl0lxj+TQ8QEobfgYBSEUAUjIZg0EDBfYKCwI0H4qcobGzju1DV0bGlgAFV/Fm550BUn0DpPzPnQDk0aC3AC2L2eac9R88adcDQLE1rNx4a2uVGdD1BpDfljhAqi1AOgHQdj89MEArPYMApDsCyFvE/IxEAyg7Y7ppLz89Pm9uCysCKHqMPzJA6tYBevv5cfohj31np44DFPJjZvCDAeQHvsIYbmNh/Wa7AeoD9Pr528tftg/pKOr2igBaWtcZQNsRQr8AqV2AtA8QKWO6af95PB2E9ARRfp1InkKAdJ8AKW1tkZ4A2iyrQpi433h9myRAb1+mdcB+uoUmAmSfxuofIPPBp2jdGj0AlBdPGKCAnezRzKZm5nL2wE93CpC2ALJO67qnb62h6zgAhcOLAcSoQwfISjYOQFZfpkYBiJWxHUD5wccESC0AXVownwW9bYAEng9ErjMIQNY0cf3X9PDK+ksoo52caLRqxnR4gecDUev45yE6B0hZAFknQNex4o0DJPB8IKpEASLdFkOSfagxX3hak11xBzjKGIgQXA4g2m0xJJljjfWFT9GaDACx6xCCywFEuy2GpDhA64/z1ql0AMSukx/c/6GJsQFot8WQ5B5m5m9WgPwTWQCIXSc/uCBAtNtiSJpRceaLaqXIzgOAROrkB5cEKJJCIsY8xbJj+V8pvf1LQgAoGXxzrYR4RrFogZ+uRQGSeNL+DQIUSDYOQKIZJZ60D4DkM44EkPuk/YJoAEg+4zgACTxpHwDJZxwGoM2T9gvOY90cQH70zgFqnJEeTST1yABVyCgHUIuM0zCaEe32AKqfcSz/TIBEBIAqRqudEQAJ6JYBqh2NmREAtdCB/QOgFjqw/yKA2qu46fBf2X9x0+IVZUtq7W/wn1ey5x8AVS45un8AVLnk6P4BUOWSo/sHQJVLju4fAFUuObr/9ucUoEMJAEEsASCIJQAEsQSAIJYAEMQSAIJYAkAQSwAIYqkQoGelHvzvvp4fpngpCZVvdb7lkl5NQPA/ScJ/GUCvnx79h+5ML9ZYS0LlgSj3J+f0agKC/3MUCf9lAL18+H5JbH93Tn0pCZVv9PbLr6c9gFxNQvCvpfyXATTdavLVO9g9/+G9uptLQuUBTYfQgmp8wf9ZEv7lANL/+66fHsgNKKjGF/yfJeFfrgub9PSRdCxcnltCrMYX/J8l4V9uED3h+/RAGo2dD6H0anzB/yWMgH/ZafxHXTSNJFYTEPxPkvCPE4kQSwAIYgkAQSwBIIglAASxBIAglgAQxBIAglgCQBBLAAhiCQBBLAEgiCUABLEEgCCWABDEEgCCWAJAEEuVAPJf8+love7t8sflzrbulNWEty9KbV6G0ofyNgF75V/hCLReeXv5o81l6LJam/B0d2KozVWsklr981e+OEDTPvlxwv9Z/fDvh5c//0399cvpiyezp67X/s+3AjS5DJ0iQhMmTe/F7UqUTcBe+eIAPd9N12q/fPj90+Pr/cPLT9MrP18+/Pbh+/QO6+m1C+buo/lmpPOdbT2J0AS9fafy9UXZBOyVLw7Qy9nR2e/J4wn1+X/v1bt5l/UAutzZJm2DI0ITzr3BFa0GRfHPXvkVxkAnow+++//+MN10dMHf68KmKr31AtlN0NYrlTtSvn/NXfniAD1NcH9cj5+L+zv9vODvDaIvd7ZJ2+CI0IT+BnCa5J+/8uWPQKeJ4Y/fLyO4f67uf79Xf7xfjJ7nkOe7IpdpfGcHoPwmfJ126M7ckzYBe+XXnMaPOEH3NHoT6vuvBtDrfYe7Jk2jN6GJf/yUAbEEgCCWABDEEgCCWAJAEEsACGIJAEEsASCIJQAEsQSAIJYAEMQSAIJYAkAQSwAIYgkAQSwBIIglAASxBIAglgAQxBIAglgCQBBLAAhiCQBBLAEgiCUABLEEgCCWABDEEgCCWAJAEEsACGIJAEEsASCIJQAEsQSAIJYAEMQSAIJYAkAQSwAIYgkAQSwBIIglAASxBIAglgAQxBIAglgCQBBLAAhiCQBBLAEgiCUABLEEgCCWABDEEgCCWAJAEEsACGIJAEEsASCIJQAEsQSAIJYAEMQSAIJYAkAQSwAIYgkAQSwBIIglAASxVAKQai/ZNsO/nP8igIqbXirhDSAarX3GrvynzTyf8Xv3SKlTQ6UZ4V9GpQC9fXmY/nn58D2/ThUVZoR/IZUC9Pr5m/VPXp0qKswI/0LiHoH+1HEDUoJ/IRWPgV7ed98HJwX/MhKbhVmTuqatkEoG/4V5i4r0eQ+4i/TBvTQgKfiXEWcM9PzDt64bkBL8C4k1C3v9/GvPDUgJ/oVUfAT6eRq+vf49NAvopQEpwb+QGGOgaR55Oopu6/TSgKTgX0Y1fgvrpQGl0eCfmpFclK7TSwNKo8E/NSO5KF2nlwaURoN/akZyUbpOLw0ojQb/1IzkonSdXhpQGg3+qRnJRek6vTSgNBr8UzOSi9J1emlAaTT4p2YkF6Xr9NKA0mjwT81ILkrX6aUBpdHgn5qRXJSu00sDSqPBPzUjuShdp5cGlEaDf2pGclG6Ti8NKI0G/9SM5KJ0nV4aUBoN/qkZyUXpOr00oDQa/FMzkot26rRswYE3QGm0XvwDoBY6sH8A1EIH9n9ogKZrip+U+tG9M3jeAAP4T0UDQPSMZJ0Aer6L3FsOgKgZyUU7dQbYACeAnj7G7qsawH8qGgCiZyTr9f7H3/51+ucfgx6Bkl0w1xNFpQClGjACQNNtDe8eX34K3Vs+CEDxLphtiiAGQNEGjAGQH8d6YNsA/pNdMNsUQQyAog0YYQMkow3gP9kFs00RVAxQogEjbIBktCH8J7pgniOaygfR8QaMsAFe7y9dVujOzhH8b+OM9niXzdJjjSH066fHwLfj+E9EGxMgu84QG+DZn0GaaEP4j0cDQPSMstEG8J/qgocA6HBjCDvaCP4TXfAQAB15DDGG/3gXPAZABx5DjO5/EIASdQbfAKP7B0D0jLLRBvcPgOgZZaMN7h8A0TPKRhvcPwCiZ5SNNrh/AETPKBttcP8AiJ5RNtrg/gEQPaNstMH9AyB6Rtlog/sHQPSMstEG9w+A6Bllow3uHwDRM8pGG9w/AKJnlI02uH8ARM9IV+q96yP4T0QDQPSMZCXfuz6A/1Q0AETPSFbyvesD+E9FA0D0jGQl37s+gP9UNABEz0hX6r3rI/hPRANA9IwCcQa7ry0RDQDRM8pGG8F/YhY5BkAHngaP4D81ixwCoNGnwaPf15aaRQ4B0PDT4MHva0vNIocAaPxp8OD3tSVmkUMAdORp8JD+8XiXQgGgTbQxAbLrDL4BRvcPgOgZZaMN4B+Pd5HSjQKEx7tI6VYBwuNdhHSzAMWjDQJQos7gG2B0/wCInlE22uD+ARA9o2y0wf0DIHpG2WiD+wdA9Iyy0Qb3D4DoGWWjDe4fANEzykYb3P8BAGrYBAC0idYTQPPrnN5++RZfbhuuH4AK/fMskVTBf08A6Zf3D1o/+5f97IXrBqAy//0AVOS/K4C0/qrUHTVcPwAV+e8IoBL//QH0kRquM4Co/nsDiOi/K4DOh9Cnwbswqv+OACrxr+wPtVVlEN0PQFH/u68tb9WEioPoHgAqDNcNQFHtvrY8Ele8ZRWn8bcCEK+d5QC5ry33bwoAQISM5KK9OgMAtPfacgBEyEgu2qvTP0C7ry3nA5S3KAAK1RkBoEQ0AJRfGQAFogGgqwNEqdslQF4L1OaP3FgyS5FyAqCCjEIKA6QAUMlyAMh8Kw8QcyunToQCoIKMQooDFBzdJZPXBih6InQIgJI/BQCgfWd8gKInQkcBKP5TgL36940k5jwZ6gsgp1YWXqUAJU6EjgJQ/KcAEkCqR4DU7Gr9HALIFG++Ov8dsrYJVOw/fiKUEZqy4+8ulwYo9VPAoQBSeQCp+Uhqmh58XJgcQHH/QwCU/CmAZCQO0F7V0AZiqhJAyqkj18+E/bcBKNinR4LRDQwO0NwZn/+bBdCyxA5AFzKVV1naPwDKrNoIIOUAFBjwhAFSIYCUmsMBoHSdygA5XYekogAFpgczLWcklPngA2TRZwBSrQAihu8PoP0zQh0CpA1AygHIIklTAVoCLstXeaKtDxD1Dr1uAUqlGQkg76LFCwjmsHIkgHZqql4Byvrdadk0hS4TZhZPLkAzIgagZWC0AqQMQH6M7gEK7o6hmvZXACgeeOXAbO/lGLMByMjQpA192rDSAUARnMYBKNxRKae8I4AsNFyAFB0gdRiAzCrSbo1IXJoODdDyUSv3C/9jEKD1O4u1Sv7TAG0TdgmQ90cZQFEHTQDypDd/xOQBtNRxCesGIIcEAMRUAqDAoSYF0PyXdr72F6zjnwCQGggglQZoaVsrgFKv7BQAKLBwoB7Df1jyACl36aMApNbiwg2QfGWnIEDpeuX+I7pdgMxMd1M3XqfUpQ68stNsUvOhEKDIMk0Bmv8/OEBrC9a5byDuMmDQTQFKvrIzBxECTYFF9cJPI4DMZggBpJyqdo2OAFJ7AKkYQAEffICSr+ysA9C2Gsd/WHNItaDiA+R3AzsAKRUASC0n5bVbI2ympAHG8NKSXYAuzdgCFDnICwCU9J/Bic4GKNidudtN1r9Z7VuAVBAgZaquJReTHQNkL3oDALkL1gVoQUIWoPl0+iXGYr8ZQGptzZI4BpCySiLDTNUWIB0BSNtcaB8R7/vWACkDkLXq4wC5G8cDyN6aTQFad4UoQMoDaGn82t6+AdL+Sh0YoHWdGn/z/64NkL3K7SOO6bEyAXIPTXUBsoBYAHIYyANIbwFa3dcGSEUAUu7yCYDWjWYB5DQi7Z8H0HantQFaOSkBaG1yqctd/xYQy15or9UYQJtyvfTKpmxtcrcAWU3Va0+tuwHIwdsFyJSsQebCNbp7YCt1uevfOUpaAGnTLLuDWJaPALTuOUu8pRGV/EcAMtac5Q0XduflAaS0thvXD0DWNjLGlrVsb4g5eiOA5k2/riSzEt1jewigdfvpEEBrjh4BMttkC9BmW1YHaKN1900A5Pgzn+bIc3ds1k+hywz/W4AWF8a7QdgCyGy/EEB2Kp7/xI/BYYCstetY8MduZvW622F7BNrzXx8gZ1ukAVqqNQJILzvn3Jp1OGN2TVNqA7Qs7gOkDXBmFTH8p34Mdjb44sdaoeagGQdoux06AihQogPLmZHRwo7dwjYALa1xAbKGZXoFaF5QtwEo9WNwGCAdBMijJBcgK1ncY7ppyetpYgBFFAbIOQZZn+yj6xUA0imA1sUdgJbCCkeg0I/BzspbhzHaXnErKsvyzrfB9e5sIovOuMdk09LX0zAAcv8O1bfWxp5LskoA0tolwwHIiS0IUOrH4GUVmfXlrLL5qBQBSKktQJslrAFdKUDp62k2g5o0QKp/gLQHkFetPUBhWQDZ8NgcrACpEEDGfmWA0tfTkAAyu4vbVY8P0CZ2Q4BWLkyXZq+y5fPqZOZCbwFyerI1Bheg9PU0OtSJSQCkvZXSBiBdBSBdGSB/Xe0AtNbfAKQ9gOY6TID26mzJkQeo1GWO/1AXtLRsC5D7KQqQ+7EpQNoCRu8BtA7ybIC23d6OfxGADB1bjrS/SBQg7S6X2Qez/G8BMi1LVdPdAuT0mqMBZI9b1hID0MVxCCC75z0WQPrqADlfW2vTBWj+xwS8MkBWieF7AUgbd0vJEABtgowAkHa+dtfmBiBrBHglgLQF0PqFC5DeArQ2LwBQucsc//HAYwF0/jICkCYAZCo2B0jnAKTTAJmjpxBA6SftJwMPB5AOAKTzANJXBkgvA5yli1pWrrKWCQJkEeKujOV4zAco8aT9dOBhAbLXtLYBWr+MAWSiNwNIWwDpCEDaZsEByDnE+ABpU4kDkPuk/a3/aN1xAXJTFgGkmwGkgwBps+n15phq+00BZGcqBSj5pP20CgEKx2kEkF1uFs4FyIuu9XY7xMyUNGD5++I/BZDeALRGMYt7AG2aWijvSfvruGtfAwPkLTwEQMYRESCrprY3iRBAQYlE6wUga/eVAcjK0QYg57M1KnaX2clUEaBpGO0nE9DAAFlFOlFTjwXQsuRYAGUtd1WArOWjAEX9dQJQxkpcaykAlBlyA1Acg3n5EoDS5emirDqerQRAOSGVlgcomowdJCtORYB8I/IA7UVOF2XViQFUlgQA5YfcArS/fAygdNXqANkfbwYgUpzKAGVVAkBiAkBLzQ4A8osAUM2MVrS806FJHzlnIUL1couKwvFWlQ9QRsaiLK3jAKDsOgCoZkYrGgAK146dTpUUAFo+AaDCLK3jFGZMXRAHgCL1AZBR6oI45mjTisRbDgC1iFMOUPSCOBGAclUK0P41xbR4GQJAllIXxI0C0M41xbR4OQJAtuIXxI0C0M41xbR4xbpZgOLRxgCIfk0xAJLOGLkcZQiACq4pBkDSGccGSKwOT30C1CZjpQviSGIB1HkDrh6tfcau/AOgFjqwfwDUQgf2jzFQCx3YfxFA7VXcdPiv7L+4afGKsiW19jf4zyvZ8w+AKpcc3T8AqlxydP8AqHLJ0f0DoMolR/cPgCqXHN1/+3MK0KEEgCCWABDEEgCCWAJAEEsACGIJAEEsASCIJQAEsVQI0LNSD/53X5X64dtcEirf6nzDGb2agOB/koT/MoBePz36r3LWbz8/riWh8kCU+5NzejUBwf85ioT/MoBePny/JLa/O6e+lITKN3r75dfTHkCuJiH411L+ywCaLrT/6h3snv/wXt3NJaHygKZDaEE1vuD/LAn/cgDp/33XTw/kBhRU4wv+z5LwL9eFTXr6SDoWLk9tIFbjC/7PkvAvN4ie8H16II3GzodQejW+4P8SRsC/7DT+oy6aRhKrCQj+J0n4x4lEiCUABLEEgCCWABDEEgCCWAJAEEsACGIJAEEsASCIJQAEsQSAIJYAEMQSAIJYAkAQSwAIYgkAQSwBIIilygD5Lzt05b/Jrj+l/L99UWrzGoielLHy+ZdQXvMIdL6xbVw93Z0YanMFawWdV77ARdzVAJr2z4/TTvCsfvj3w8uf/6b++uX0xZPZay83tvWqff+TpjeCdqjclS9wG0k1gJ7vpoPky4ffPz2+3j+8/DS9+PDlw28fvk9v8mDrwwoAAADiSURBVJ1ev/DQdxeW47/bBuSufIEb2aoB9DLd8KjPrk8eT6jP/3uv3q3I97r+J2X5/9TiJrAC5a78ngE6t+LBb8N/f5huPhrhCJTh33qZbHfKW/k9d2FPE9wf16Po0oY7/TzGEWjff5t7CIuUu/J7HkRPN6z9+P0yjvvn2obf79Uf79djZs8A7fv/Ou3KfQ6is1f+GNP4NveL19PQ/mubrw7Q6323u2mWhvbfwDx+yoBYAkAQSwAIYgkAQSwBIIglAASxBIAglgAQxBIAglgCQBBLAAhiCQBBLAEgiCUABLH0/xURwTsduj5QAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
</div>
<div id="gelman-rubin-method-for-exercise-9.4" class="section level2">
<h2>Gelman-Rubin method for Exercise 9.4</h2>
<div id="problem-22" class="section level3">
<h3>Problem</h3>
<p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span></p>
</div>
<div id="solution-22" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb88-2"><a href="#cb88-2"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb88-3"><a href="#cb88-3"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb88-4"><a href="#cb88-4"></a>psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb88-5"><a href="#cb88-5"></a>n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb88-6"><a href="#cb88-6"></a>k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb88-7"><a href="#cb88-7"></a>psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb88-8"><a href="#cb88-8"></a>B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb88-9"><a href="#cb88-9"></a>psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb88-10"><a href="#cb88-10"></a>W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb88-11"><a href="#cb88-11"></a>v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb88-12"><a href="#cb88-12"></a>r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic</span></span>
<span id="cb88-13"><a href="#cb88-13"></a><span class="kw">return</span>(r.hat)</span>
<span id="cb88-14"><a href="#cb88-14"></a>}</span>
<span id="cb88-15"><a href="#cb88-15"></a></span>
<span id="cb88-16"><a href="#cb88-16"></a>k &lt;-<span class="st"> </span><span class="dv">4</span>    <span class="co"># four chains</span></span>
<span id="cb88-17"><a href="#cb88-17"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>,<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">10</span>)    <span class="co"># overdispersed initial values</span></span>
<span id="cb88-18"><a href="#cb88-18"></a>N &lt;-<span class="st"> </span><span class="dv">10000</span>    <span class="co"># length of chains</span></span>
<span id="cb88-19"><a href="#cb88-19"></a>b &lt;-<span class="st"> </span><span class="dv">200</span>    <span class="co"># burn-in length</span></span>
<span id="cb88-20"><a href="#cb88-20"></a></span>
<span id="cb88-21"><a href="#cb88-21"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb88-22"><a href="#cb88-22"></a></span>
<span id="cb88-23"><a href="#cb88-23"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>N)</span>
<span id="cb88-24"><a href="#cb88-24"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb88-25"><a href="#cb88-25"></a>  X[i,] &lt;-<span class="st"> </span><span class="kw">rw.Metro.Laplace</span>(<span class="fl">0.2</span>,x0[i],N)<span class="op">$</span>x</span>
<span id="cb88-26"><a href="#cb88-26"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb88-27"><a href="#cb88-27"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb88-28"><a href="#cb88-28"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb88-29"><a href="#cb88-29"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb88-30"><a href="#cb88-30"></a><span class="cf">for</span> (j <span class="cf">in</span> (<span class="dv">1000</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb88-31"><a href="#cb88-31"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb88-32"><a href="#cb88-32"></a><span class="kw">plot</span>(rhat[(<span class="dv">1000</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;sigma=0.2&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb88-33"><a href="#cb88-33"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb88-34"><a href="#cb88-34"></a></span>
<span id="cb88-35"><a href="#cb88-35"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>N)</span>
<span id="cb88-36"><a href="#cb88-36"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb88-37"><a href="#cb88-37"></a>  X[i,] &lt;-<span class="st"> </span><span class="kw">rw.Metro.Laplace</span>(<span class="dv">1</span>,x0[i],N)<span class="op">$</span>x</span>
<span id="cb88-38"><a href="#cb88-38"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb88-39"><a href="#cb88-39"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb88-40"><a href="#cb88-40"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb88-41"><a href="#cb88-41"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb88-42"><a href="#cb88-42"></a><span class="cf">for</span> (j <span class="cf">in</span> (<span class="dv">500</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb88-43"><a href="#cb88-43"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb88-44"><a href="#cb88-44"></a>x2 &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">which</span>(rhat<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>rhat<span class="op">&lt;</span><span class="fl">1.2</span>))</span>
<span id="cb88-45"><a href="#cb88-45"></a><span class="kw">plot</span>(rhat[(<span class="dv">500</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;sigma=1&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb88-46"><a href="#cb88-46"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb88-47"><a href="#cb88-47"></a></span>
<span id="cb88-48"><a href="#cb88-48"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>N)</span>
<span id="cb88-49"><a href="#cb88-49"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb88-50"><a href="#cb88-50"></a>  X[i,] &lt;-<span class="st"> </span><span class="kw">rw.Metro.Laplace</span>(<span class="dv">4</span>,x0[i],N)<span class="op">$</span>x</span>
<span id="cb88-51"><a href="#cb88-51"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb88-52"><a href="#cb88-52"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb88-53"><a href="#cb88-53"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb88-54"><a href="#cb88-54"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb88-55"><a href="#cb88-55"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb88-56"><a href="#cb88-56"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb88-57"><a href="#cb88-57"></a>x3 &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">which</span>(rhat<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>rhat<span class="op">&lt;</span><span class="fl">1.2</span>))</span>
<span id="cb88-58"><a href="#cb88-58"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;sigma=4&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb88-59"><a href="#cb88-59"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb88-60"><a href="#cb88-60"></a></span>
<span id="cb88-61"><a href="#cb88-61"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>N)</span>
<span id="cb88-62"><a href="#cb88-62"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb88-63"><a href="#cb88-63"></a>  X[i,] &lt;-<span class="st"> </span><span class="kw">rw.Metro.Laplace</span>(<span class="dv">16</span>,x0[i],N)<span class="op">$</span>x</span>
<span id="cb88-64"><a href="#cb88-64"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb88-65"><a href="#cb88-65"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb88-66"><a href="#cb88-66"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb88-67"><a href="#cb88-67"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb88-68"><a href="#cb88-68"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb88-69"><a href="#cb88-69"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb88-70"><a href="#cb88-70"></a>x4 &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">which</span>(rhat<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>rhat<span class="op">&lt;</span><span class="fl">1.2</span>))</span>
<span id="cb88-71"><a href="#cb88-71"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;sigma=16&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb88-72"><a href="#cb88-72"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb88-73"><a href="#cb88-73"></a></span>
<span id="cb88-74"><a href="#cb88-74"></a><span class="kw">c</span>(x2,x3,x4)</span></code></pre></div>
<p>From the result, we know that from our simulation:</p>
<ol style="list-style-type: decimal">
<li><p>When <span class="math inline">\(\sigma=0.5\)</span>, the chain don’t converge in the first <span class="math inline">\(N=10000\)</span> iterations based on the criteria <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p></li>
<li><p>When <span class="math inline">\(\sigma=1\)</span>, the chain converges at <span class="math inline">\(N=5611\)</span> iteration based on the criteria <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p></li>
<li><p>When <span class="math inline">\(\sigma=4\)</span>, the chain converges at <span class="math inline">\(N=525\)</span> iteration based on the criteria <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p></li>
<li><p>When <span class="math inline">\(\sigma=16\)</span>, the chain converges at <span class="math inline">\(N=2860\)</span> iteration based on the criteria <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p></li>
</ol>
</div>
</div>
<div id="exercise-11.4" class="section level2">
<h2>Exercise 11.4</h2>
<div id="problem-23" class="section level3">
<h3>Problem</h3>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt{k})\)</span> of the curves <span class="math display">\[
S_{k-1}(a)=P\left(t(k-1)&gt;\sqrt{\frac{a^{2}(k-1)}{k-a^{2}}}\right)
\]</span> and <span class="math display">\[
S_{k}(a)=P\left(t(k)&gt;\sqrt{\frac{a^{2} k}{k+1-a^{2}}}\right)
\]</span> for <span class="math inline">\(k=4:25,100,500,1000\)</span>, where t(k) is a Student t random variable with k degrees of freedom.</p>
</div>
<div id="solution-23" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a>S &lt;-<span class="st"> </span><span class="cf">function</span>(k,a) {</span>
<span id="cb89-2"><a href="#cb89-2"></a>  tmp &lt;-<span class="st"> </span><span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb89-3"><a href="#cb89-3"></a>  <span class="kw">pt</span>(tmp, <span class="dt">df=</span>k)</span>
<span id="cb89-4"><a href="#cb89-4"></a>}</span>
<span id="cb89-5"><a href="#cb89-5"></a>k_store &lt;-<span class="st"> </span><span class="dv">4</span><span class="op">:</span><span class="dv">25</span></span>
<span id="cb89-6"><a href="#cb89-6"></a></span>
<span id="cb89-7"><a href="#cb89-7"></a>result &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(k_store)<span class="op">+</span><span class="dv">3</span>)</span>
<span id="cb89-8"><a href="#cb89-8"></a>count &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb89-9"><a href="#cb89-9"></a></span>
<span id="cb89-10"><a href="#cb89-10"></a><span class="cf">for</span> (k <span class="cf">in</span> k_store) {</span>
<span id="cb89-11"><a href="#cb89-11"></a>  count &lt;-<span class="st"> </span>count<span class="op">+</span><span class="dv">1</span></span>
<span id="cb89-12"><a href="#cb89-12"></a>  target &lt;-<span class="st"> </span><span class="cf">function</span>(a) {</span>
<span id="cb89-13"><a href="#cb89-13"></a>    <span class="kw">S</span>(k,a)<span class="op">-</span><span class="kw">S</span>(k<span class="dv">-1</span>,a)</span>
<span id="cb89-14"><a href="#cb89-14"></a>  }</span>
<span id="cb89-15"><a href="#cb89-15"></a>  out &lt;-<span class="st"> </span><span class="kw">uniroot</span>(target,  <span class="dt">lower =</span> <span class="fl">0.001</span>, <span class="dt">upper =</span> <span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">0.1</span>)</span>
<span id="cb89-16"><a href="#cb89-16"></a>  result[count] &lt;-<span class="st"> </span>out<span class="op">$</span>root</span>
<span id="cb89-17"><a href="#cb89-17"></a>}</span>
<span id="cb89-18"><a href="#cb89-18"></a></span>
<span id="cb89-19"><a href="#cb89-19"></a>target_<span class="dv">100</span> &lt;-<span class="st"> </span><span class="cf">function</span>(a) {</span>
<span id="cb89-20"><a href="#cb89-20"></a>    <span class="kw">S</span>(<span class="dv">100</span>,a)<span class="op">-</span><span class="kw">S</span>(<span class="dv">99</span>,a)</span>
<span id="cb89-21"><a href="#cb89-21"></a>  }</span>
<span id="cb89-22"><a href="#cb89-22"></a>out &lt;-<span class="st"> </span><span class="kw">uniroot</span>(target_<span class="dv">100</span>,  <span class="dt">lower =</span> <span class="fl">0.001</span>, <span class="dt">upper =</span> <span class="kw">sqrt</span>(<span class="dv">100</span>)<span class="op">-</span><span class="dv">4</span>)    <span class="co"># To avoid meeting upper bound</span></span>
<span id="cb89-23"><a href="#cb89-23"></a>result[<span class="dv">23</span>] &lt;-<span class="st"> </span>out<span class="op">$</span>root</span>
<span id="cb89-24"><a href="#cb89-24"></a></span>
<span id="cb89-25"><a href="#cb89-25"></a>target_<span class="dv">500</span> &lt;-<span class="st"> </span><span class="cf">function</span>(a) {</span>
<span id="cb89-26"><a href="#cb89-26"></a>    <span class="kw">S</span>(<span class="dv">500</span>,a)<span class="op">-</span><span class="kw">S</span>(<span class="dv">499</span>,a)</span>
<span id="cb89-27"><a href="#cb89-27"></a>  }</span>
<span id="cb89-28"><a href="#cb89-28"></a>out &lt;-<span class="st"> </span><span class="kw">uniroot</span>(target_<span class="dv">500</span>,  <span class="dt">lower =</span> <span class="fl">0.001</span>, <span class="dt">upper =</span> <span class="kw">sqrt</span>(<span class="dv">500</span>)<span class="op">-</span><span class="dv">20</span>)    <span class="co"># To avoid meeting upper bound</span></span>
<span id="cb89-29"><a href="#cb89-29"></a>result[<span class="dv">24</span>] &lt;-<span class="st"> </span>out<span class="op">$</span>root</span>
<span id="cb89-30"><a href="#cb89-30"></a></span>
<span id="cb89-31"><a href="#cb89-31"></a>target_<span class="dv">1000</span> &lt;-<span class="st"> </span><span class="cf">function</span>(a) {</span>
<span id="cb89-32"><a href="#cb89-32"></a>    <span class="kw">S</span>(<span class="dv">1000</span>,a)<span class="op">-</span><span class="kw">S</span>(<span class="dv">999</span>,a)</span>
<span id="cb89-33"><a href="#cb89-33"></a>  }</span>
<span id="cb89-34"><a href="#cb89-34"></a>out &lt;-<span class="st"> </span><span class="kw">uniroot</span>(target_<span class="dv">1000</span>,  <span class="dt">lower =</span> <span class="fl">0.001</span>, <span class="dt">upper =</span> <span class="kw">sqrt</span>(<span class="dv">1000</span>)<span class="op">-</span><span class="dv">25</span>)    <span class="co"># To avoid meeting upper bound</span></span>
<span id="cb89-35"><a href="#cb89-35"></a>result[<span class="dv">25</span>] &lt;-<span class="st"> </span>out<span class="op">$</span>root</span>
<span id="cb89-36"><a href="#cb89-36"></a></span>
<span id="cb89-37"><a href="#cb89-37"></a><span class="kw">cbind</span>(<span class="dt">k=</span><span class="kw">c</span>(k_store,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>),result)</span></code></pre></div>
<pre><code>##          k   result
##  [1,]    4 1.492096
##  [2,]    5 1.533581
##  [3,]    6 1.562759
##  [4,]    7 1.584417
##  [5,]    8 1.601163
##  [6,]    9 1.614516
##  [7,]   10 1.625383
##  [8,]   11 1.634409
##  [9,]   12 1.642025
## [10,]   13 1.648539
## [11,]   14 1.654176
## [12,]   15 1.659097
## [13,]   16 1.663437
## [14,]   17 1.667311
## [15,]   18 1.670731
## [16,]   19 1.673832
## [17,]   20 1.676639
## [18,]   21 1.679130
## [19,]   22 1.681457
## [20,]   23 1.683585
## [21,]   24 1.685542
## [22,]   25 1.687346
## [23,]  100 1.720600
## [24,]  500 1.729718
## [25,] 1000 1.730897</code></pre>
</div>
</div>
</div>
<div id="homework-9-2020-11-24" class="section level1">
<h1>Homework 9 (2020-11-24)</h1>
<div id="a-b-o-blood-type-problem" class="section level2">
<h2>A-B-O blood type problem</h2>
<div id="problem-24" class="section level3">
<h3>Problem</h3>
<p>Let the three alleles be A, B and O.</p>
<p>(Table omitted)</p>
<p>Observed data: A-type: <span class="math inline">\(n_{A \cdot }=444\)</span></p>
<p>B-type: <span class="math inline">\(n_{B \cdot }=132\)</span></p>
<p>O-type: <span class="math inline">\(n_{OO}=361\)</span></p>
<p>AB-type: <span class="math inline">\(n_{AB}=63\)</span></p>
<ol style="list-style-type: decimal">
<li>Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>. (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>)</li>
<li>Record the values of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</li>
</ol>
</div>
<div id="solution-24" class="section level3">
<h3>Solution</h3>
<p>Observed data likelihood: <span class="math display">\[
L(p,q|n_{A\cdot},n_{B\cdot},n_{OO},n_{AB})=(p^2+2p(1-p-q))^{n_{A\cdot}}(q^2+2q(1-p-q))^{n_{B\cdot}}((1-p-q)^2)^{n_{OO}}(2pq)^{n_{AB}}
\]</span></p>
<p>Complete data likelihood: <span class="math display">\[
L(p,q|n_{AA},n_{BB},n_{OO},n_{AO},n_{BO},n_{AB})=(p^2)^{n_{AA}}(q^2)^{n_{BB}}((1-p-q)^2)^{n_{OO}}(2p(1-p-q))^{n_{AO}}(2q(1-p-q))^{n_{BO}}(2pq)^{n_{AB}}
\]</span> <span class="math display">\[
L(p,q|n_{A\cdot},n_{B\cdot},n_{OO},n_{AB},n_{AA},n_{BB})=(p^2)^{n_{AA}}(q^2)^{n_{BB}}((1-p-q)^2)^{n_{OO}}(2p(1-p-q))^{n_{A\cdot}-n_{AA}}(2q(1-p-q))^{n_{B\cdot}-n_{BB}}(2pq)^{n_{AB}}
\]</span></p>
<p><span class="math display">\[
l(p,q|n_{A\cdot},n_{B\cdot},n_{OO},n_{AB},n_{AA},n_{BB}) = 2n_{OO}\log (1-p-q) + n_{AB} \log (pq) + n_{A\cdot}\log (p(1-p-q)) + n_{B\cdot}\log (q(1-p-q)) + n_{AA}\log (p/(1-p-q)) + n_{BB}\log (q/(1-p-q)) 
\]</span> E-Step: <span class="math display">\[
\begin{aligned}
&amp;E_{\hat{p}_0,\hat{q}_0}[l(p,q|n_{A\cdot},n_{B\cdot},n_{OO},n_{AB},n_{AA},n_{BB})|n_{A\cdot},n_{B\cdot},n_{OO},n_{AB}]\\
&amp;= 2n_{OO}\log (1-p-q) + n_{AB} \log (pq) + n_{A\cdot}\log (p(1-p-q)) + n_{B\cdot}\log (q(1-p-q))\\
&amp;+ \frac{\hat{p}_0^2}{\hat{p}_0^2+2 \hat{p}_0(1-\hat{p}_0-\hat{q}_0)} n_{A\cdot}\log (p/(1-p-q)) + \frac{\hat{q}_0^2}{\hat{q}_0^2+2 \hat{q}_0(1-\hat{p}_0-\hat{q}_0)} n_{B\cdot}\log (q/(1-p-q))
\end{aligned}
\]</span></p>
<p>M-Step: <span class="math display">\[
\hat{p}_1=\frac{1}{2n}(2n_{A\cdot}\frac{\hat{p}_0^2}{\hat{p}_0^2+2 \hat{p}_0(1-\hat{p}_0-\hat{q}_0)}+n_{A\cdot}\frac{2 \hat{p}_0(1-\hat{p}_0-\hat{q}_0)}{\hat{p}_0^2+2 \hat{p}_0(1-\hat{p}_0-\hat{q}_0)}+n_{AB})
\]</span> <span class="math display">\[
\hat{q}_1=\frac{1}{2n}(2n_{B\cdot}\frac{\hat{q}_0^2}{\hat{q}_0^2+2 \hat{q}_0(1-\hat{p}_0-\hat{q}_0)}+n_{B\cdot}\frac{2 \hat{q}_0(1-\hat{p}_0-\hat{q}_0)}{\hat{q}_0^2+2 \hat{p}_0(1-\hat{p}_0-\hat{q}_0)}+n_{AB})
\]</span></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a>na &lt;-<span class="st"> </span><span class="dv">444</span></span>
<span id="cb91-2"><a href="#cb91-2"></a>nb &lt;-<span class="st"> </span><span class="dv">132</span></span>
<span id="cb91-3"><a href="#cb91-3"></a>noo &lt;-<span class="st"> </span><span class="dv">361</span></span>
<span id="cb91-4"><a href="#cb91-4"></a>nab &lt;-<span class="st"> </span><span class="dv">63</span></span>
<span id="cb91-5"><a href="#cb91-5"></a>n &lt;-<span class="st"> </span>na<span class="op">+</span>nb<span class="op">+</span>noo<span class="op">+</span>nab</span>
<span id="cb91-6"><a href="#cb91-6"></a>p &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb91-7"><a href="#cb91-7"></a>q &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb91-8"><a href="#cb91-8"></a>condlike &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb91-9"><a href="#cb91-9"></a>p[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="fl">0.5</span>    <span class="co"># Initial value</span></span>
<span id="cb91-10"><a href="#cb91-10"></a>q[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="fl">0.2</span>    <span class="co"># Initial value</span></span>
<span id="cb91-11"><a href="#cb91-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>) {</span>
<span id="cb91-12"><a href="#cb91-12"></a>  x1 &lt;-<span class="st"> </span>p[i]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(p[i]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p[i]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p[i]<span class="op">-</span>q[i]))</span>
<span id="cb91-13"><a href="#cb91-13"></a>  x2 &lt;-<span class="st"> </span>q[i]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(q[i]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q[i]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p[i]<span class="op">-</span>q[i]))</span>
<span id="cb91-14"><a href="#cb91-14"></a>  r &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p[i]<span class="op">-</span>q[i]</span>
<span id="cb91-15"><a href="#cb91-15"></a>  condlike[i] &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>noo<span class="op">*</span><span class="kw">log</span>(r) <span class="op">+</span><span class="st"> </span>nab<span class="op">*</span><span class="kw">log</span>(p[i]<span class="op">*</span>q[i]) <span class="op">+</span><span class="st"> </span>na<span class="op">*</span><span class="kw">log</span>(p[i]<span class="op">*</span>r) <span class="op">+</span><span class="st"> </span>nb<span class="op">*</span><span class="kw">log</span>(q[i]<span class="op">*</span>r) <span class="op">+</span><span class="st"> </span>x1<span class="op">*</span>na<span class="op">*</span><span class="kw">log</span>(p[i]<span class="op">/</span>r) <span class="op">+</span><span class="st"> </span>x2<span class="op">*</span>nb<span class="op">*</span><span class="kw">log</span>(q[i]<span class="op">/</span>r)</span>
<span id="cb91-16"><a href="#cb91-16"></a>  p[i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>na<span class="op">*</span>x1<span class="op">+</span>na<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x1)<span class="op">+</span>nab)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</span>
<span id="cb91-17"><a href="#cb91-17"></a>  q[i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>nb<span class="op">*</span>x2<span class="op">+</span>nb<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x2)<span class="op">+</span>nab)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</span>
<span id="cb91-18"><a href="#cb91-18"></a>  r &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p[i<span class="op">+</span><span class="dv">1</span>]<span class="op">-</span>q[i<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb91-19"><a href="#cb91-19"></a>}</span>
<span id="cb91-20"><a href="#cb91-20"></a>r &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p[<span class="dv">10</span>]<span class="op">-</span>q[<span class="dv">10</span>]</span>
<span id="cb91-21"><a href="#cb91-21"></a>condlike[<span class="dv">10</span>] &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>noo<span class="op">*</span><span class="kw">log</span>(r) <span class="op">+</span><span class="st"> </span>nab<span class="op">*</span><span class="kw">log</span>(p[<span class="dv">10</span>]<span class="op">*</span>q[<span class="dv">10</span>]) <span class="op">+</span><span class="st"> </span>na<span class="op">*</span><span class="kw">log</span>(p[<span class="dv">10</span>]<span class="op">*</span>r) <span class="op">+</span><span class="st"> </span>nb<span class="op">*</span><span class="kw">log</span>(q[<span class="dv">10</span>]<span class="op">*</span>r) <span class="op">+</span><span class="st"> </span>x1<span class="op">*</span>na<span class="op">*</span><span class="kw">log</span>(p[<span class="dv">10</span>]<span class="op">/</span>r) <span class="op">+</span><span class="st"> </span>x2<span class="op">*</span>nb<span class="op">*</span><span class="kw">log</span>(q[<span class="dv">10</span>]<span class="op">/</span>r)</span>
<span id="cb91-22"><a href="#cb91-22"></a></span>
<span id="cb91-23"><a href="#cb91-23"></a><span class="kw">data.frame</span>(<span class="dt">p=</span>p,<span class="dt">q=</span>q,<span class="dt">conditional_log_likelihood=</span>condlike)</span></code></pre></div>
<pre><code>##            p         q conditional_log_likelihood
## 1  0.5000000 0.2000000                  -2138.309
## 2  0.3544091 0.1140000                  -1834.233
## 3  0.3090018 0.1038915                  -1806.187
## 4  0.2997498 0.1028649                  -1802.872
## 5  0.2980256 0.1027319                  -1802.342
## 6  0.2977106 0.1027107                  -1802.248
## 7  0.2976534 0.1027071                  -1802.231
## 8  0.2976430 0.1027064                  -1802.228
## 9  0.2976411 0.1027063                  -1802.227
## 10 0.2976407 0.1027063                  -1802.227</code></pre>
<p>From the result, we could find that the corresponding log-maximum likelihood values are increasing. The parameters converge after 9 iterations. The estimated <span class="math inline">\(\hat{p}=0.2976407,~~\hat{q}=0.1027063\)</span></p>
</div>
</div>
<div id="exercises-3-p204" class="section level2">
<h2>Exercises 3 (P204)</h2>
<div id="problem-25" class="section level3">
<h3>Problem</h3>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<p>formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt, mpg ~ I(1 / disp) + wt )</p>
</div>
<div id="solution-25" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="kw">attach</span>(mtcars)</span>
<span id="cb93-2"><a href="#cb93-2"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb93-3"><a href="#cb93-3"></a>mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb93-4"><a href="#cb93-4"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb93-5"><a href="#cb93-5"></a>mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb93-6"><a href="#cb93-6"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb93-7"><a href="#cb93-7"></a>)</span>
<span id="cb93-8"><a href="#cb93-8"></a></span>
<span id="cb93-9"><a href="#cb93-9"></a><span class="co"># loops</span></span>
<span id="cb93-10"><a href="#cb93-10"></a>models_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb93-11"><a href="#cb93-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb93-12"><a href="#cb93-12"></a>  models_<span class="dv">1</span>[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(formulas[[i]])</span>
<span id="cb93-13"><a href="#cb93-13"></a>models_<span class="dv">1</span></span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="co"># lapply</span></span>
<span id="cb95-2"><a href="#cb95-2"></a>models_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb95-3"><a href="#cb95-3"></a>models_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas, <span class="cf">function</span>(x) <span class="kw">lm</span>(x))</span>
<span id="cb95-4"><a href="#cb95-4"></a>models_<span class="dv">2</span></span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
</div>
<div id="exercises-3-p213" class="section level2">
<h2>Exercises 3 (P213)</h2>
<div id="problem-26" class="section level3">
<h3>Problem</h3>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<p>trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE )</p>
<p>Extra challenge: get rid of the anonymous function by using [[ directly.</p>
</div>
<div id="solution-26" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb97-2"><a href="#cb97-2"></a><span class="dv">100</span>,</span>
<span id="cb97-3"><a href="#cb97-3"></a><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb97-4"><a href="#cb97-4"></a><span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb97-5"><a href="#cb97-5"></a>)</span>
<span id="cb97-6"><a href="#cb97-6"></a><span class="kw">sapply</span>(trials, (<span class="cf">function</span>(x) x[[<span class="st">&#39;p.value&#39;</span>]]))</span></code></pre></div>
<pre><code>##   [1] 0.07117554 0.62033641 0.43748589 0.79442851 0.07907674 0.79088495
##   [7] 0.12719411 0.05146878 0.73032721 0.29291370 0.37742331 0.79010396
##  [13] 0.83351492 0.80564489 0.74909759 0.38298284 0.90803990 0.10057939
##  [19] 0.10512960 0.97662420 0.09753150 0.10444059 0.23323142 0.57173463
##  [25] 0.87038383 0.73093172 0.83319434 0.73855863 0.55232805 0.01079548
##  [31] 0.88098028 0.26390299 0.47814278 0.76330439 0.64797225 0.74717936
##  [37] 0.24666759 0.01497308 0.90092990 0.62201682 0.61395015 0.58523070
##  [43] 0.18923033 0.25443558 0.96491075 0.03147520 0.09974982 0.78751682
##  [49] 0.09219353 0.50199861 0.62743535 0.77595120 0.38097159 0.54327290
##  [55] 0.72761540 0.72639827 0.64843487 0.82103195 0.06166524 0.84951608
##  [61] 0.67496219 0.21199482 0.87805322 0.01974717 0.54971668 0.48082379
##  [67] 0.01040104 0.83292427 0.65126790 0.96844390 0.25942469 0.29464802
##  [73] 0.58925510 0.53538065 0.30254633 0.27326479 0.97036931 0.37979510
##  [79] 0.34254824 0.95329304 0.05540916 0.24316689 0.29454995 0.59402599
##  [85] 0.18958669 0.33655461 0.68243512 0.10385217 0.79709998 0.17275542
##  [91] 0.31582674 0.81653685 0.38327468 0.56334057 0.59348975 0.31475327
##  [97] 0.23459041 0.44549778 0.96031601 0.48277756</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a><span class="kw">sapply</span>(trials, <span class="st">&#39;[[&#39;</span>, <span class="st">&#39;p.value&#39;</span>)    <span class="co"># extra challenge</span></span></code></pre></div>
<pre><code>##   [1] 0.07117554 0.62033641 0.43748589 0.79442851 0.07907674 0.79088495
##   [7] 0.12719411 0.05146878 0.73032721 0.29291370 0.37742331 0.79010396
##  [13] 0.83351492 0.80564489 0.74909759 0.38298284 0.90803990 0.10057939
##  [19] 0.10512960 0.97662420 0.09753150 0.10444059 0.23323142 0.57173463
##  [25] 0.87038383 0.73093172 0.83319434 0.73855863 0.55232805 0.01079548
##  [31] 0.88098028 0.26390299 0.47814278 0.76330439 0.64797225 0.74717936
##  [37] 0.24666759 0.01497308 0.90092990 0.62201682 0.61395015 0.58523070
##  [43] 0.18923033 0.25443558 0.96491075 0.03147520 0.09974982 0.78751682
##  [49] 0.09219353 0.50199861 0.62743535 0.77595120 0.38097159 0.54327290
##  [55] 0.72761540 0.72639827 0.64843487 0.82103195 0.06166524 0.84951608
##  [61] 0.67496219 0.21199482 0.87805322 0.01974717 0.54971668 0.48082379
##  [67] 0.01040104 0.83292427 0.65126790 0.96844390 0.25942469 0.29464802
##  [73] 0.58925510 0.53538065 0.30254633 0.27326479 0.97036931 0.37979510
##  [79] 0.34254824 0.95329304 0.05540916 0.24316689 0.29454995 0.59402599
##  [85] 0.18958669 0.33655461 0.68243512 0.10385217 0.79709998 0.17275542
##  [91] 0.31582674 0.81653685 0.38327468 0.56334057 0.59348975 0.31475327
##  [97] 0.23459041 0.44549778 0.96031601 0.48277756</code></pre>
</div>
</div>
<div id="exercises-6-p214" class="section level2">
<h2>Exercises 6 (P214)</h2>
<div id="problem-27" class="section level3">
<h3>Problem</h3>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
</div>
<div id="solution-27" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>lapply_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="cf">function</span>(X, FUN, FUN.VALUE) {</span>
<span id="cb101-2"><a href="#cb101-2"></a>  <span class="kw">return</span>(<span class="kw">Map</span>(<span class="cf">function</span>(x) <span class="kw">vapply</span>(x,FUN,FUN.VALUE),X))</span>
<span id="cb101-3"><a href="#cb101-3"></a>}</span>
<span id="cb101-4"><a href="#cb101-4"></a>list_comb &lt;-<span class="st"> </span><span class="kw">list</span>(cars,mtcars,faithful)</span>
<span id="cb101-5"><a href="#cb101-5"></a><span class="kw">lapply_1</span>(list_comb, mean, <span class="kw">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [[1]]
## speed  dist 
## 15.40 42.98 
## 
## [[2]]
##        mpg        cyl       disp         hp       drat         wt       qsec 
##  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 
##         vs         am       gear       carb 
##   0.437500   0.406250   3.687500   2.812500 
## 
## [[3]]
## eruptions   waiting 
##  3.487783 70.897059</code></pre>
</div>
</div>
</div>
<div id="homework-10-2020-12-01" class="section level1">
<h1>Homework 10 (2020-12-01)</h1>
<div id="problem-28" class="section level3">
<h3>Problem</h3>
<p>1.Write an Rcpp function for Exercise 9.4.</p>
<p>2.Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</p>
<p>3.Compare the computation time of the two functions with the function “microbenchmark”.</p>
<p>4.Comments your results.</p>
</div>
<div id="solution-28" class="section level2">
<h2>Solution</h2>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="co"># Rcpp function for Exercise 9.4 (rwC.cpp)</span></span>
<span id="cb103-2"><a href="#cb103-2"></a></span>
<span id="cb103-3"><a href="#cb103-3"></a><span class="co">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb103-4"><a href="#cb103-4"></a>using namespace Rcpp;</span>
<span id="cb103-5"><a href="#cb103-5"></a><span class="op">/</span><span class="er">/</span><span class="st"> </span>[[Rcpp<span class="op">::</span>export]]</span>
<span id="cb103-6"><a href="#cb103-6"></a>NumericVector <span class="kw">rwC</span> (double sigma, double x0, int N) {</span>
<span id="cb103-7"><a href="#cb103-7"></a>    NumericVector u =<span class="st"> </span><span class="kw">runif</span>(N);</span>
<span id="cb103-8"><a href="#cb103-8"></a>    NumericVector <span class="kw">x</span>(N);</span>
<span id="cb103-9"><a href="#cb103-9"></a>    x[<span class="dv">0</span>] =<span class="st"> </span>x0;</span>
<span id="cb103-10"><a href="#cb103-10"></a>    <span class="cf">for</span> (int <span class="dt">i=</span><span class="dv">1</span>; i <span class="op">&lt;=</span><span class="st"> </span>N<span class="dv">-1</span>; i<span class="op">++</span>) {</span>
<span id="cb103-11"><a href="#cb103-11"></a>        NumericVector y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma);</span>
<span id="cb103-12"><a href="#cb103-12"></a>        <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="kw">abs</span>(y[<span class="dv">0</span>]))) {</span>
<span id="cb103-13"><a href="#cb103-13"></a>            x[i] =<span class="st"> </span>y[<span class="dv">0</span>];</span>
<span id="cb103-14"><a href="#cb103-14"></a>        }</span>
<span id="cb103-15"><a href="#cb103-15"></a>        <span class="cf">if</span> (u[i] <span class="op">&gt;</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="kw">abs</span>(y[<span class="dv">0</span>]))) {</span>
<span id="cb103-16"><a href="#cb103-16"></a>            x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>];</span>
<span id="cb103-17"><a href="#cb103-17"></a>        }</span>
<span id="cb103-18"><a href="#cb103-18"></a>    }</span>
<span id="cb103-19"><a href="#cb103-19"></a>    <span class="kw">return</span>(x);</span>
<span id="cb103-20"><a href="#cb103-20"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="co"># R function for Exercise 9.4 (my homework)</span></span>
<span id="cb104-2"><a href="#cb104-2"></a></span>
<span id="cb104-3"><a href="#cb104-3"></a>rw.Metro.Laplace &lt;-<span class="st"> </span><span class="cf">function</span>(sigma,x0,N) {</span>
<span id="cb104-4"><a href="#cb104-4"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb104-5"><a href="#cb104-5"></a>  x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb104-6"><a href="#cb104-6"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb104-7"><a href="#cb104-7"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb104-8"><a href="#cb104-8"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb104-9"><a href="#cb104-9"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean=</span>x[i<span class="dv">-1</span>], <span class="dt">sd=</span>sigma)</span>
<span id="cb104-10"><a href="#cb104-10"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="kw">abs</span>(y)))</span>
<span id="cb104-11"><a href="#cb104-11"></a>      x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb104-12"><a href="#cb104-12"></a>        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb104-13"><a href="#cb104-13"></a>        k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb104-14"><a href="#cb104-14"></a>      }</span>
<span id="cb104-15"><a href="#cb104-15"></a>  }</span>
<span id="cb104-16"><a href="#cb104-16"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x,<span class="dt">k=</span>k))</span>
<span id="cb104-17"><a href="#cb104-17"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="kw">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Rcpp&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="kw">sourceCpp</span>(<span class="st">&quot;rwC.cpp&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in normalizePath(path.expand(path), winslash, mustWork): path[1]=&quot;C:/
## Users/Zhang Jin/Desktop/Statistical Computing/StatComp20007/vignettes/../inst/
## include&quot;: 系统找不到指定的路径。</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a>sigma &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb109-2"><a href="#cb109-2"></a>x0 &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb109-3"><a href="#cb109-3"></a>N &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb109-4"><a href="#cb109-4"></a><span class="kw">qqplot</span>(<span class="kw">rwC</span>(sigma,x0,N), <span class="kw">rw.Metro.Laplace</span>(sigma,x0,N)<span class="op">$</span>x)</span>
<span id="cb109-5"><a href="#cb109-5"></a><span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The corresponding generated random numbers could be assumed same, because the Q-Q plot of these two data mostly scatters near the diagonal line.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="kw">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;microbenchmark&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a>ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rwC=</span><span class="kw">rwC</span>(sigma,x0,N), <span class="dt">rwR=</span><span class="kw">rw.Metro.Laplace</span>(sigma,x0,N)<span class="op">$</span>x)</span>
<span id="cb112-2"><a href="#cb112-2"></a><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr      lq   median      uq
## 1  rwC   794.9   810.65   913.0
## 2  rwR 12122.9 13573.55 15704.9</code></pre>
<p>It’s clear that Rcpp function takes much shorter time than R function. Thus, Rcpp can tremendously increase the efficiency.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
